<?xml version="1.0" encoding="utf-8"?>
<post><title>security - Disable firefox same origin policy - Stack Overflow</title><question><text><div class="post-text" itemprop="text">
<p>I'm developing a local research tool that requires me to turn off Firefox's same origin policy (in terms of script access, I don't really care about cross domain requests). </p>
<p>More specifically, I want scripts in the host domain to be able to access arbitrary elements in any iframes embedded in the page, regardless of their domain.</p>
<p>I'm aware previous Q&amp;As which mentioned the CORS FF extension, but that is not what I need, since it only allows CORS, but not script access.</p>
<p>If it cannot be done easily, I would also appreciate any insights that point me to specific part of FF src code that I can modify to disable SOP, so that I can recompile FF.</p>
<p>Many thanks in advance.</p>
</div></text><author><a href="/users/2482460/yuchen-zhou">Yuchen Zhou</a></author><comments><comment><text><span class="comment-copy">It would be an interesting thing with developers. Since the same origin policy is designed for the security of the users and not the developers, it should be made possible to allow the scripts from the <b>given</b> site to go across the restrictions. But developers are also people, so you could loose your personal information as well.</span></text><author><a class="comment-user" href="/users/531954/danubian-sailor" title="15,268 reputation">Danubian Sailor</a></author></comment><comment><text><span class="comment-copy">I believe it's not possible right now, here is related bug report in Firefox Bugzilla: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1039678" rel="nofollow noreferrer">bugzilla.mozilla.org/show_bug.cgi?id=1039678</a></span></text><author><a class="comment-user" href="/users/391865/rutsky" title="1,576 reputation">rutsky</a></author></comment><comment><text><span class="comment-copy">Found it, check my answer :)</span></text><author><a class="comment-user" href="/users/1974399/giacomo-tecya-pigani" title="1,185 reputation">Giacomo Tecya Pigani</a></author></comment></comments></question><answers><answer><text><div class="post-text" itemprop="text">
<p>There's a Firefox extension that adds the CORS headers to any HTTP response working on the latest Firefox (<strong>build 36.0.1</strong>) released <strong>March 5, 2015</strong>.
I tested it and it's working on both Windows 7 and Mavericks. I'll guide you throught the steps to get it working.</p>
<p><strong>1) Getting the extension</strong></p>
<p>You can either download the xpi from <a href="http://spenibus.net/files/gitbin/cors-everywhere-firefox-addon/">here</a> (author builds) or from <a href="https://app.box.com/s/52as3pbhkkbar2hfkem7qamfhbsr0le7">here</a> 
(mirror, may not be updated).</p>
<p>Or download the <a href="https://github.com/spenibus/cors-everywhere-firefox-addon">files</a> from GitHub.
Now it's also on Firefox Marketplace: <a href="https://addons.mozilla.org/cs/firefox/addon/cors-everywhere/?src=userprofile">Download here</a>. In this case, the addon is installed after you click install and you can skip to step 4.</p>
<p>If you downloaded the xpi you can jump to step 3. If you downloaded the zip from GitHub, go to step 2.</p>
<p><strong>2) Building the xpi</strong></p>
<p>You need to extract the zip, get inside the "cors-everywhere-firefox-addon-master" folder, select all the items and zip them.
Then, rename the created zip as *.xpi</p>
<p>Note: If you are using the OS X gui, it may create some hidden files, so you 'd be better using the command line.</p>
<p><strong>3) Installing the xpi</strong></p>
<p>You can just drag and drop the xpi to firefox, or go to: "about:addons", click on the cog on the top right corner and select "install add on from file", then select you .xpi file. Now, restart firefox.</p>
<p><strong>4) Getting it to work</strong></p>
<p>Now, the extension won't be working by default. You need to drag the extension icon to the extension bar, but don't worry. There are pictures!</p>
<ul>
<li>Click on the Firefox Menu</li>
<li>Click on Customise</li>
</ul>
<p><img alt="p1" src="https://i.stack.imgur.com/VSspG.png"/></p>
<ul>
<li>Drag CorsE to the bar</li>
<li>Now, click on the icon, when it's green the CORS headers will be added to any HTTP response</li>
</ul>
<p><img alt="p2" src="https://i.stack.imgur.com/ead0z.png"/></p>
<p><strong>5) Testing if it's working</strong></p>
<p>jQuery</p>
<pre><code>$.get( "http://example.com/", function( data ) {
  console.log (data);
});
</code></pre>
<p>JavaScript</p>
<pre><code>xmlhttp=new XMLHttpRequest();

xmlhttp.onreadystatechange = function() {
    if (xmlhttp.readyState == 4) {
        console.log(xmlhttp.responseText);
    }
}

xmlhttp.open("GET","http://example.com/");
xmlhttp.send();
</code></pre>
<p><strong>6) Final considerations</strong></p>
<p>Note that <a href="http://www.w3.org/TR/access-control/#user-agent-security">https to http is not allowed</a>.</p>
<p>There may be a way around it, but it's behind the scope of the question.</p>
</div></text><author><a href="/users/1974399/giacomo-tecya-pigani">Giacomo Tecya Pigani</a></author><comments><comment><text><span class="comment-copy">You can disable HTTP/HTTPS mixed content protection by setting <code>security.mixed_content.block_active_content</code> to <b>false</b> and <code>security.mixed_content.block_display_content</code> to <b>true</b>. Keep in mind you are disabling some security and this should be a temporary solution.</span></text><author><a class="comment-user" href="/users/248390/bufh" title="1,906 reputation">bufh</a></author></comment><comment><text><span class="comment-copy">As the author of this addon, I'm not actually convinced it would solve this particular question. It's nice to get a mention though.</span></text><author><a class="comment-user" href="/users/3512867/spenibus" title="3,453 reputation">spenibus</a></author></comment><comment><text><span class="comment-copy">@spenibus - you should get your add on signed - I can't install it :( - <a href="https://support.mozilla.org/en-US/kb/add-on-signing-in-firefox?as=u&amp;utm_source=inproduct" rel="nofollow noreferrer">support.mozilla.org/en-US/kb/â€¦</a></span></text><author><a class="comment-user" href="/users/186636/peter-ajtai" title="41,032 reputation">Peter Ajtai</a></author></comment><comment><text><span class="comment-copy">@PeterAjtai Mozilla keeps on trying hard to annoy me I see. Awaiting review: <a href="https://addons.mozilla.org/en-US/firefox/addon/cors-everywhere/" rel="nofollow noreferrer">addons.mozilla.org/en-US/firefox/addon/cors-everywhere</a> Should hopefully get auto signed.</span></text><author><a class="comment-user" href="/users/3512867/spenibus" title="3,453 reputation">spenibus</a></author></comment><comment><text><span class="comment-copy">doesnt work for me. CorsE icon is green, but XmlHttpRequest returns just empty String for example.com or google.com. It works for a file on localhost - so the example script should be ok.</span></text><author><a class="comment-user" href="/users/5133904/alex" title="171 reputation">Alex</a></author></comment><comment><text><span class="comment-copy">in about:config set <b>xpinstall.signatures.required</b> to <b>false</b> to install the addon. It worked for me.</span></text><author><a class="comment-user" href="/users/2345998/user2345998" title="389 reputation">user2345998</a></author></comment><comment><text><span class="comment-copy">Use Chrome because it's so much easier to disable CORS for developing.</span></text><author><a class="comment-user" href="/users/239171/pete-alvin" title="1,454 reputation">Pete Alvin</a></author></comment><comment><text><span class="comment-copy"><a href="https://addons.mozilla.org/de/firefox/addon/cors-everywhere/" rel="nofollow noreferrer">addons.mozilla.org/de/firefox/addon/cors-everywhere</a> This is the addon mentioned above. It works great.</span></text><author><a class="comment-user" href="/users/3975652/type-style" title="1,077 reputation">Type-Style</a></author></comment><comment><text><span class="comment-copy">Great explanation and works for me in firefox 45</span></text><author><a class="comment-user" href="/users/2519704/martin-naughton" title="114 reputation">Martin Naughton</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<pre><code>about:config -&gt; security.fileuri.strict_origin_policy -&gt; false
</code></pre>
</div></text><author><a href="/users/1979703/niklas">Niklas</a></author><comments><comment><text><span class="comment-copy">Thanks @Niklas, however, i think this only disables fileuri same origin policy checks - probably used for local web dev testing.  It still stops me when I'm trying to access DOM nodes in an iframe with domain B from a JavaScript in domain A.</span></text><author><a class="comment-user owner" href="/users/2482460/yuchen-zhou" title="391 reputation">Yuchen Zhou</a></author></comment><comment><text><span class="comment-copy">this doesn't do anything</span></text><author><a class="comment-user" href="/users/780812/vknyvz" title="198 reputation">vknyvz</a></author></comment><comment><text><span class="comment-copy">As vknyvz says, it is useless</span></text><author><a class="comment-user" href="/users/870776/eversor" title="1,509 reputation">eversor</a></author></comment><comment><text><span class="comment-copy">Confirmed it does work in my firefox (developer) version: 40. Thank you for the tip @Niklas.</span></text><author><a class="comment-user" href="/users/248390/bufh" title="1,906 reputation">bufh</a></author></comment><comment><text><span class="comment-copy">Just found about <code>XOriginPolicy</code>, <code>sendRefererHeader</code>, <code>spoofSource</code> which may be useful for <i>testing purposes</i> bypassing CORS and all (sources: <a href="http://www.ghacks.net/2015/01/22/improve-online-privacy-by-controlling-referrer-information/" rel="nofollow noreferrer">ghacks.net</a>, <a href="http://b.agilob.net/better-security-privacy-and-anonymity-in-firefox/" rel="nofollow noreferrer">b.agilob.net</a>).</span></text><author><a class="comment-user" href="/users/248390/bufh" title="1,906 reputation">bufh</a></author></comment><comment><text><span class="comment-copy">This is a setting specifically for debugging, and controls a local files access to other local files (set to true a local file can only access local files in the same folder or sub folders, set to false a local file can access all local files). <a href="http://kb.mozillazine.org/Security.fileuri.strict_origin_policy" rel="nofollow noreferrer">Source</a></span></text><author><a class="comment-user" href="/users/592111/jon-egerton" title="24,696 reputation">Jon Egerton</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>I realized my older answer is downvoted because I didn't specify how to disable FF's same origin policy specifically. Here I will give a more detailed answer:</p>
<p>Warning: This requires a re-compilation of FF, and the newly compiled version of Firefox will not be able to <em>enable</em> SOP again.</p>
<p>Check out Mozilla's Firefox's source code, find nsScriptSecurityManager.cpp in the src directory.
I will use the one listed here as example:
<a href="http://mxr.mozilla.org/aviarybranch/source/caps/src/nsScriptSecurityManager.cpp" rel="noreferrer">http://mxr.mozilla.org/aviarybranch/source/caps/src/nsScriptSecurityManager.cpp</a></p>
<p>Go to the function implementation nsScriptSecurityManager::CheckSameOriginURI, which is line 568 as of date 03/02/2016.</p>
<p>Make that function always return NS_OK.</p>
<p>This will disable SOP for good.</p>
<p>The browser addon answer by @Giacomo should be useful for most people and I have accepted that answer, however, for my personal research needs (TL;won't explain here) it is not enough and I figure other researchers may need to do what I did here to fully kill SOP.</p>
</div></text><author><a href="/users/2482460/yuchen-zhou">Yuchen Zhou</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>As of <strong>September 2016</strong> this addon is the best to disable <strong>CORS</strong>: <a href="https://github.com/fredericlb/Force-CORS/releases" rel="nofollow noreferrer">https://github.com/fredericlb/Force-CORS/releases</a></p>
<p>In the options panel you can configure which header to inject and specific website to have it enabled automatically.</p>
<p><a href="https://i.stack.imgur.com/kLFrb.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/kLFrb.png"/></a></p>
</div></text><author><a href="/users/2875424/khado-mikhal">Khado Mikhal</a></author><comments/></answer></answers></post>