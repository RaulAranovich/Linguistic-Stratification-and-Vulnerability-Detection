<?xml version="1.0" encoding="utf-8"?>
<post><title>security - How do you set up use HttpOnly cookies in PHP - Stack Overflow</title><question><text><div class="post-text" itemprop="text">
<p>How can I set the cookies in my <code>PHP apps</code> as <code>HttpOnly cookies</code>?</p>
</div></text><author><a href="/users/4248328/alive-to-die">Alive to Die</a></author><comments><comment><text><span class="comment-copy"><a href="http://stackoverflow.com/questions/528405/which-browsers-do-support-httponly-cookies" title="which browsers do support httponly cookies">stackoverflow.com/questions/528405/…</a> Has the browser support info.</span></text><author><a class="comment-user" href="/users/69993/kzqai" title="12,386 reputation">Kzqai</a></author></comment><comment><text><span class="comment-copy">@Tchalvak No, the current answers are still authoritative. Nothing has changed since 2008 regarding HTTP-only cookie setting in PHP. <i>Which browsers support HTTP-only cookies</i> is a different question, with a different answer.</span></text><author><a class="comment-user" href="/users/643827/lanzz" title="27,037 reputation">lanzz</a></author></comment><comment><text><span class="comment-copy">You may use <code>$cookie-&gt;setHttpOnly(true);</code> with <a href="https://github.com/delight-im/PHP-Cookie" rel="nofollow noreferrer">github.com/delight-im/PHP-Cookie</a></span></text><author><a class="comment-user" href="/users/89818/caw" title="8,936 reputation">caw</a></author></comment></comments></question><answers><answer><text><div class="post-text" itemprop="text">
<ul>
<li>For <strong>your cookies</strong>, see this answer. </li>
<li>For <strong>PHP's own session cookie</strong> (<code>PHPSESSID</code>, by default), see <a href="http://stackoverflow.com/a/8726269/1820">@richie's answer</a></li>
</ul>
<p>The <a href="http://php.net/manual/en/function.setcookie.php" rel="nofollow noreferrer"><code>setcookie()</code></a> and <a href="http://php.net/manual/en/function.setrawcookie.php" rel="nofollow noreferrer"><code>setrawcookie()</code></a> functions, introduced the <code>httponly</code> parameter, back in the dark ages of PHP 5.2.0, making this nice and easy. Simply set the 7th parameter to true, as per the syntax</p>
<p><em>Function syntax simplified for brevity</em></p>
<pre class="lang-php prettyprint prettyprinted" style=""><code><span class="pln">setcookie</span><span class="pun">(</span><span class="pln">    $name</span><span class="pun">,</span><span class="pln"> $value</span><span class="pun">,</span><span class="pln"> $expire</span><span class="pun">,</span><span class="pln"> $path</span><span class="pun">,</span><span class="pln"> $domain</span><span class="pun">,</span><span class="pln"> $secure</span><span class="pun">,</span><span class="pln"> $httponly </span><span class="pun">)</span><span class="pln">
setrawcookie</span><span class="pun">(</span><span class="pln"> $name</span><span class="pun">,</span><span class="pln"> $value</span><span class="pun">,</span><span class="pln"> $expire</span><span class="pun">,</span><span class="pln"> $path</span><span class="pun">,</span><span class="pln"> $domain</span><span class="pun">,</span><span class="pln"> $secure</span><span class="pun">,</span><span class="pln"> $httponly </span><span class="pun">)</span></code></pre>
<p>Enter <code>NULL</code> for parameters you wish to remain as default.
You may also want to consider if you should be setting the <code>secure</code> parameter.</p>
<p>It is also possible using the older, lower-level <a href="http://php.net/manual/en/function.header.php" rel="nofollow noreferrer"><code>header()</code></a> function:</p>
<pre class="lang-php prettyprint prettyprinted" style=""><code><span class="pln">header</span><span class="pun">(</span><span class="pln"> </span><span class="str">"Set-Cookie: name=value; httpOnly"</span><span class="pln"> </span><span class="pun">);</span></code></pre>
</div></text><author><a href="/users/1820/cheekysoft">Cheekysoft</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>For PHP's own session cookies on Apache:<br/>
add this to your Apache configuration or <code>.htaccess</code></p>
<pre class="lang-php prettyprint prettyprinted" style=""><code><span class="tag">&lt;IfModule</span><span class="pln"> </span><span class="atn">php5_module</span><span class="tag">&gt;</span><span class="pln">
    php_flag session.cookie_httponly on
</span><span class="tag">&lt;/IfModule&gt;</span></code></pre>
<p>This can also be set within a script, as long as it is called before <code>session_start()</code>.</p>
<pre class="lang-php prettyprint prettyprinted" style=""><code><span class="pln">ini_set</span><span class="pun">(</span><span class="pln"> </span><span class="str">'session.cookie_httponly'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">);</span></code></pre>
</div></text><author><a href="/users/1105047/richie">richie</a></author><comments><comment><text><span class="comment-copy">+1 as this is a good thing (for security) to have in place on your entire server but instead added to the <code>php.ini</code>.</span></text><author><a class="comment-user" href="/users/881551/anthony-hatzopoulos" title="7,397 reputation">Anthony Hatzopoulos</a></author></comment><comment><text><span class="comment-copy">Please note php_flag should be used instead: "Don't use php_value to set boolean values. php_flag should be used instead." <a href="http://php.net/manual/en/configuration.changes.php" rel="nofollow noreferrer">php.net/manual/en/configuration.changes.php</a></span></text><author><a class="comment-user" href="/users/464890/ondrej-machulda" title="596 reputation">Ondrej Machulda</a></author></comment><comment><text><span class="comment-copy">@OndrejMachulda Changing <code>php_value</code> to <code>php_flag</code> doesn't work. I just tried it on my server..</span></text><author><a class="comment-user" href="/users/1101095/nate" title="5,992 reputation">Nate</a></author></comment><comment><text><span class="comment-copy">@Nate: When changing to <code>php_flag</code>, you must change also the value - to either <code>on</code> or <code>off</code> - see the manual.</span></text><author><a class="comment-user" href="/users/464890/ondrej-machulda" title="596 reputation">Ondrej Machulda</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>Be aware that HttpOnly doesn't stop cross-site scripting; instead, it neutralizes one possible attack, and currently does that only on IE (FireFox exposes HttpOnly cookies in XmlHttpRequest, and Safari doesn't honor it at all). By all means, turn HttpOnly on, but don't drop even an hour of output filtering and fuzz testing in trade for it.</p>
</div></text><author><a href="/users/5674/tqbf">tqbf</a></author><comments><comment><text><span class="comment-copy">This situation may have changed since '08, now. Here is a more current/updated list: <a href="http://stackoverflow.com/questions/528405/which-browsers-do-support-httponly-cookies" title="which browsers do support httponly cookies">stackoverflow.com/questions/528405/…</a></span></text><author><a class="comment-user" href="/users/69993/kzqai" title="12,386 reputation">Kzqai</a></author></comment><comment><text><span class="comment-copy">I really want to remove my downvote.</span></text><author><a class="comment-user" href="/users/6388243/stephen-leppik" title="3,760 reputation">Stephen Leppik</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>Note that PHP session cookies don't use <code>httponly</code> by default.</p>
<p>To do that:</p>
<pre class="lang-php prettyprint prettyprinted" style=""><code><span class="pln">$sess_name </span><span class="pun">=</span><span class="pln"> session_name</span><span class="pun">();</span><span class="pln">
</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">session_start</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    setcookie</span><span class="pun">(</span><span class="pln">$sess_name</span><span class="pun">,</span><span class="pln"> session_id</span><span class="pun">(),</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> </span><span class="str">'/'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>A couple of items of note here:</p>
<ul>
<li>You have to call <code>session_name()</code>
before <code>session_start()</code> </li>
<li>This also
sets the default path to '/', which
is necessary for Opera but which PHP
session cookies don't do by default
either.</li>
</ul>
</div></text><author><a>NONE</a></author><comments><comment><text><span class="comment-copy"><a href="http://php.net/manual/en/function.session-set-cookie-params.php" rel="nofollow noreferrer">php.net/manual/en/function.session-set-cookie-params.php</a> It can be done automatically via the above PHP function instead of custom coding.</span></text><author><a class="comment-user" href="/users/99215/ryaner" title="469 reputation">Ryaner</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>You can specify it in the set cookie function <a href="http://uk.php.net/setcookie" rel="nofollow noreferrer">see the php manual</a></p>
<pre class="lang-php prettyprint prettyprinted" style=""><code><span class="pln">setcookie</span><span class="pun">(</span><span class="str">'Foo'</span><span class="pun">,</span><span class="str">'Bar'</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="str">'/'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'www.sample.com'</span><span class="pln">  </span><span class="pun">,</span><span class="pln"> FALSE</span><span class="pun">,</span><span class="pln"> TRUE</span><span class="pun">);</span></code></pre>
</div></text><author><a href="/users/2098/re0sless">Re0sless</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>Explanation here from Ilia... 5.2 only though</p>
<p><a href="http://ilia.ws/archives/121-httpOnly-cookie-flag-support-in-PHP-5.2.html" rel="nofollow noreferrer">httpOnly cookie flag support in PHP 5.2</a></p>
<p>As stated in that article, you can set the header yourself in previous versions of PHP</p>
<pre class="lang-php prettyprint prettyprinted" style=""><code><span class="pln">header</span><span class="pun">(</span><span class="str">"Set-Cookie: hidden=value; httpOnly"</span><span class="pun">);</span></code></pre>
</div></text><author><a href="/users/137/polsonby">Polsonby</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<pre class="lang-php prettyprint prettyprinted" style=""><code><span class="pun">&lt;?</span><span class="pln">php
</span><span class="com">//None HttpOnly cookie:</span><span class="pln">
setcookie</span><span class="pun">(</span><span class="str">"abc"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"test"</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">,</span><span class="pln"> FALSE</span><span class="pun">);</span><span class="pln"> 

</span><span class="com">//HttpOnly cookie:</span><span class="pln">
setcookie</span><span class="pun">(</span><span class="str">"abc"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"test"</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">,</span><span class="pln"> TRUE</span><span class="pun">);</span><span class="pln"> 

</span><span class="pun">?&gt;</span></code></pre>
<p><a href="http://ilia.ws/archives/121-httpOnly-cookie-flag-support-in-PHP-5.2.html" rel="nofollow noreferrer">Source</a></p>
</div></text><author><a href="/users/1585/marius">Marius</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>You can use this in a header file.</p>
<pre class="lang-php prettyprint prettyprinted" style=""><code><span class="com">// setup session enviroment</span><span class="pln">
ini_set</span><span class="pun">(</span><span class="str">'session.cookie_httponly'</span><span class="pun">,</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
ini_set</span><span class="pun">(</span><span class="str">'session.use_only_cookies'</span><span class="pun">,</span><span class="lit">1</span><span class="pun">);</span></code></pre>
<p>This way all future cookies will use httponly.</p>
</div></text><author><a href="/users/2335501/marius">Marius</a></author><comments><comment><text><span class="comment-copy">Just FYI session.use_only_cookies is on by default in PHP &gt;5.3</span></text><author><a class="comment-user" href="/users/543315/nic-cottrell" title="3,514 reputation">Nic Cottrell</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>The right syntax of the php_flag command is</p>
<pre class="lang-php prettyprint prettyprinted" style=""><code><span class="pln">php_flag  session</span><span class="pun">.</span><span class="pln">cookie_httponly </span><span class="typ">On</span></code></pre>
<p>And be aware, just first answer from server set the cookie and here (for example You can see the "HttpOnly" directive. So for testing delete cookies from browser after every testing request.</p>
</div></text><author><a href="/users/1117506/mareg">Mareg</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<pre class="lang-php prettyprint prettyprinted" style=""><code><span class="pln">php_flag session</span><span class="pun">.</span><span class="pln">cookie_httponly </span><span class="typ">On</span></code></pre>
<p>This is right</p>
</div></text><author><a href="/users/6490141/gideon-afoh">Gideon Afoh</a></author><comments><comment><text><span class="comment-copy">This does not provide an answer to the question. Once you have sufficient <a href="http://stackoverflow.com/help/whats-reputation">reputation</a> you will be able to <a href="http://stackoverflow.com/help/privileges/comment">comment on any post</a>; instead, <a href="http://meta.stackexchange.com/questions/214173/why-do-i-need-50-reputation-to-comment-what-can-i-do-instead">provide answers that don't require clarification from the asker</a>. - <a href="/review/low-quality-posts/15699028">From Review</a></span></text><author><a class="comment-user" href="/users/4929646/danila-ganchar" title="2,417 reputation">Danila Ganchar</a></author></comment><comment><text><span class="comment-copy">@DanilaGanchar A code-only answer might not be a good one, but it's still an answer. I would recommend you this post about the LQPRQ: <a href="http://meta.stackoverflow.com/questions/287563/youre-doing-it-wrong-a-plea-for-sanity-in-the-low-quality-posts-queue">You're doing it wrong: A plea for sanity in the Low Quality Posts queue</a></span></text><author><a class="comment-user" href="/users/4687348/felixsfd" title="3,062 reputation">FelixSFD</a></author></comment></comments></answer></answers></post>