<?xml version="1.0" encoding="utf-8"?>
<post><title>How to add Active Directory user group as login in SQL Server - Stack Overflow</title><question><text><div class="post-text" itemprop="text">
<p>I have a .net application which is connecting to the SQL Server using windows authentication. </p>
<p>We cannot use SQL Server authentication in the application. We have lot of Active Directory users there for our project. So we have to create separate login account for each Active Directory users in SQL Server rather than creating separate login account for each AD users, is there any way to use the active directory user group in SQL Server? </p>
</div></text><author><a href="/users/41956/abatishchev">abatishchev</a></author><comments/></question><answers><answer><text><div class="post-text" itemprop="text">
<p>In SQL Server Management Studio, go to <code>Object Explorer &gt; (your server) &gt; Security &gt; Logins</code> and right-click <code>New Login</code>:</p>
<p><img alt="enter image description here" src="https://i.stack.imgur.com/oiHrb.png"/></p>
<p>Then in the dialog box that pops up, pick the types of objects you want to see (<code>Groups</code> is disabled by default - check it!) and pick the location where you want to look for your objects (e.g. use <code>Entire Directory</code>) and then find your AD group.</p>
<p><img alt="enter image description here" src="https://i.stack.imgur.com/l8a6R.png"/></p>
<p>You now have a regular SQL Server Login - just like when you create one for a single AD user. Give that new login the permissions on the databases it needs, and off you go!</p>
<p>Any member of that AD group can now login to SQL Server and use your database.</p>
</div></text><author><a href="/users/13302/marc-s">marc_s</a></author><comments><comment><text><span class="comment-copy">Thanks For this, Ideal.</span></text><author><a class="comment-user" href="/users/1324741/derek" title="4,163 reputation">Derek</a></author></comment><comment><text><span class="comment-copy">Is there any chance to create groups in mysql like above?</span></text><author><a class="comment-user" href="/users/104085/uzay95" title="5,003 reputation">uzay95</a></author></comment><comment><text><span class="comment-copy">@uzay95: sorry, no idea - I don't know MySQL. But since it's a cross-platform database, I doubt it has something very Windows-specific like that...</span></text><author><a class="comment-user" href="/users/13302/marc-s" title="483,980 reputation">marc_s</a></author></comment><comment><text><span class="comment-copy">Thanks. I was looking for this.</span></text><author><a class="comment-user" href="/users/1251660/slayedbylucifer" title="12,419 reputation">slayedbylucifer</a></author></comment><comment><text><span class="comment-copy">Thank you for a very clear answer with annotated screen shots!  I wish all answers were like this...</span></text><author><a class="comment-user" href="/users/229587/nickg" title="3,313 reputation">NickG</a></author></comment><comment><text><span class="comment-copy">How did you produce the annotations on the screenshot @marc_s?</span></text><author><a class="comment-user" href="/users/229587/nickg" title="3,313 reputation">NickG</a></author></comment><comment><text><span class="comment-copy">@NickG: the red rounded rectangles and arrows? Yes that's my work :-)</span></text><author><a class="comment-user" href="/users/13302/marc-s" title="483,980 reputation">marc_s</a></author></comment><comment><text><span class="comment-copy">@NickG: I used the free <b>Paint.NET</b> to load the image and insert the rounded red rectangles</span></text><author><a class="comment-user" href="/users/13302/marc-s" title="483,980 reputation">marc_s</a></author></comment><comment><text><span class="comment-copy">This doesn't work for me.  I have a Windows Group "DataAccess", which "UserX" is a member of.  I created a login for DataAccess group and set the login's user mapping to have public, datareader, and datawriter access on a database.  The user can't log in.  If I add the user specifically, and assign the exact same mapping permission, then he can log in.  When I click on Securables &gt; Effective Permissions for the group, it says "Cannot execute as the server principal because the principal 'GroupName' does not exit, this type of principal cannot be impersonated, or you do not have permission."</span></text><author><a class="comment-user" href="/users/88409/triynko" title="8,997 reputation">Triynko</a></author></comment><comment><text><span class="comment-copy">Is there a way, how to do it in TSQL? I need to add this user everytime I restore backup from another computer.</span></text><author><a class="comment-user" href="/users/518530/qub1n" title="7,615 reputation">qub1n</a></author></comment><comment><text><span class="comment-copy">@Triynko it looks like it only works for AD groups, not local groups</span></text><author><a class="comment-user" href="/users/1543844/snowburnt" title="2,362 reputation">Snowburnt</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>You can use T-SQL:</p>
<pre class="lang-sql prettyprint prettyprinted" style=""><code><span class="kwd">use</span><span class="pln"> master
GO
</span><span class="kwd">CREATE</span><span class="pln"> LOGIN </span><span class="pun">[</span><span class="pln">NT AUTHORITY</span><span class="pun">\</span><span class="pln">LOCALSERVICE</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">FROM</span><span class="pln"> WINDOWS </span><span class="kwd">WITH</span><span class="pln">
DEFAULT_DATABASE</span><span class="pun">=</span><span class="pln">yourDbName
GO
</span><span class="kwd">CREATE</span><span class="pln"> LOGIN </span><span class="pun">[</span><span class="pln">NT AUTHORITY</span><span class="pun">\</span><span class="pln">NETWORKSERVICE</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">FROM</span><span class="pln"> WINDOWS </span><span class="kwd">WITH</span><span class="pln">
DEFAULT_DATABASE</span><span class="pun">=</span><span class="pln">yourDbName</span></code></pre>
<p>I use this as a part of restore from production server to testing machine:</p>
<pre class="lang-sql prettyprint prettyprinted" style=""><code><span class="kwd">USE</span><span class="pln"> master
GO
</span><span class="kwd">ALTER</span><span class="pln"> </span><span class="kwd">DATABASE</span><span class="pln"> yourDbName </span><span class="kwd">SET</span><span class="pln"> OFFLINE </span><span class="kwd">WITH</span><span class="pln"> </span><span class="kwd">ROLLBACK</span><span class="pln"> IMMEDIATE
</span><span class="kwd">RESTORE</span><span class="pln"> </span><span class="kwd">DATABASE</span><span class="pln"> yourDbName </span><span class="kwd">FROM</span><span class="pln"> </span><span class="kwd">DISK</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">'d:\DropBox\backup\myDB.bak'</span><span class="pln">
</span><span class="kwd">ALTER</span><span class="pln"> </span><span class="kwd">DATABASE</span><span class="pln"> yourDbName </span><span class="kwd">SET</span><span class="pln"> ONLINE
GO
</span><span class="kwd">CREATE</span><span class="pln"> LOGIN </span><span class="pun">[</span><span class="pln">NT AUTHORITY</span><span class="pun">\</span><span class="pln">LOCALSERVICE</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">FROM</span><span class="pln"> WINDOWS </span><span class="kwd">WITH</span><span class="pln">
DEFAULT_DATABASE</span><span class="pun">=</span><span class="pln">yourDbName
GO
</span><span class="kwd">CREATE</span><span class="pln"> LOGIN </span><span class="pun">[</span><span class="pln">NT AUTHORITY</span><span class="pun">\</span><span class="pln">NETWORKSERVICE</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">FROM</span><span class="pln"> WINDOWS </span><span class="kwd">WITH</span><span class="pln">
DEFAULT_DATABASE</span><span class="pun">=</span><span class="pln">yourDbName
GO</span></code></pre>
<p>You will need to use localized name of services in case of German or French Windows, see <a href="http://stackoverflow.com/questions/6496451/how-to-create-a-sql-server-login-for-a-service-account-on-a-non-english-windows">How to create a SQL Server login for a service account on a non-English Windows?</a></p>
</div></text><author><a href="/users/518530/qub1n">qub1n</a></author><comments><comment><text><span class="comment-copy">In case you also need to set the database level login/principal, here's another answer I found useful <a href="http://dba.stackexchange.com/a/2578/60876">dba.stackexchange.com/a/2578/60876</a></span></text><author><a class="comment-user" href="/users/1600770/agostino" title="759 reputation">Agostino</a></author></comment></comments></answer></answers></post>