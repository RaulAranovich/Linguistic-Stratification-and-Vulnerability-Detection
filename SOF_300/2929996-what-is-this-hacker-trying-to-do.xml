<?xml version="1.0" encoding="utf-8"?>
<post><title>sql server - What is this hacker trying to do? - Stack Overflow</title><question><text><div class="post-text" itemprop="text">
<p>If you do a search for:</p>
<p><a href="http://www.google.co.uk/search?q=0x57414954464F522044454C4159202730303A30303A313527&amp;hl=en&amp;start=30&amp;sa=N" rel="noreferrer">http://www.google.co.uk/search?q=0x57414954464F522044454C4159202730303A30303A313527&amp;hl=en&amp;start=30&amp;sa=N</a></p>
<p>you will see a lot of examples of an attempted hack along the lines of:</p>
<pre class="lang-sql prettyprint prettyprinted" style=""><code><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">declare</span><span class="pln"> </span><span class="pun">@</span><span class="pln">q varchar</span><span class="pun">(</span><span class="lit">8000</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">select</span><span class="pln"> </span><span class="pun">@</span><span class="pln">q </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0x57414954464F522044454C4159202730303A30303A313527</span><span class="pln"> </span><span class="kwd">exec</span><span class="pun">(@</span><span class="pln">q</span><span class="pun">)</span><span class="pln"> </span><span class="com">--</span></code></pre>
<p>What is exactly is it trying to do? Which db is it trying to work on? 
Do you know of any advisories about this?</p>
</div></text><author><a href="/users/183528/rook">rook</a></author><comments><comment><text><span class="comment-copy">It appears to translate to <code>WAITFOR DELAY '00:00:15'</code> - slow down some scripts? Crawlers?</span></text><author><a class="comment-user" href="/users/327563/konerak" title="28,671 reputation">Konerak</a></author></comment><comment><text><span class="comment-copy">Perhaps if the server doesn't reply for 15+ seconds, the hacker knows that the server was vulnerable to this attack.  It might be a way to detect compromised SQL servers using a command that doesn't leave much trace (15 second delay) but is detectable nevertheless.</span></text><author><a class="comment-user" href="/users/188704/heath-hunnicutt" title="12,767 reputation">Heath Hunnicutt</a></author></comment><comment><text><span class="comment-copy">Wow! There's a lot of results for that search :S</span></text><author><a class="comment-user" href="/users/191347/justin" title="2,149 reputation">Justin</a></author></comment><comment><text><span class="comment-copy">btw its encoded like that so that it doesn't need quote marks. the same encoding technique works on other db's like mysql.</span></text><author><a class="comment-user" href="/users/183528/rook" title="43,765 reputation">rook</a></author></comment></comments></question><answers><answer><text><div class="post-text" itemprop="text">
<p>He is testing your server for SQL Injection,  specifically this is a robust test that will work even if its <a href="http://en.wikipedia.org/wiki/SQL_injection#Blind_SQL_injection" rel="noreferrer">Blind SQL Injection</a>.  Blind SQL Injection is when an attacker is able to execute SQL however,  there isn't a viewable response.   If the http request takes at least 15 seconds the attacker will know that he can execute SQL, and that your running MS-SQL.   After this attack he will follow it up with a <a href="http://www.securiteam.com/securityreviews/5DP0N1P76E.html" rel="noreferrer">xp_cmpdshell()</a> to infect your server. </p>
</div></text><author><a href="/users/183528/rook">rook</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>According to <a href="http://bytes.com/topic/mysql/answers/888849-hacker-attempt" rel="noreferrer">http://bytes.com/topic/mysql/answers/888849-hacker-attempt</a> it looks like it's trying to run:</p>
<p>WAITFOR DELAY '00:00:15'</p>
<p>As others have pointed out it's not a DOS attack (as I originally stated) but merely a way to easily determine if the SQL Server is vulnerable and can be added to a list of hosts to perhaps further hack away at later on.</p>
</div></text><author><a href="/users/89783/alistair">Alistair</a></author><comments><comment><text><span class="comment-copy">Your 1/2 right,  too bad no hacker is going to go out of his way to DoS random servers.</span></text><author><a class="comment-user" href="/users/183528/rook" title="43,765 reputation">rook</a></author></comment><comment><text><span class="comment-copy">This is not a DoS attack (the wait for delay has little impact on the database -- there are better DoS attacks like forcing the return of a lot of rows). It's a blind test for SQL injection vulnerabilities. If the app is vulnerable the database will pause for 15s allowing the attacker to detect the vulnerability by measuring the delay in the HTTP response.</span></text><author><a class="comment-user" href="/users/224263/flpmor" title="826 reputation">flpmor</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>In simpler terms he/she/it is very slick. Using the "WAITFOR DELAY..." strategy allows he/she/it to see if the server is vulnerable <strong>without logging anything</strong>. The check is being done to see what access the connectionstring user has in the db. And like @Rook said, thT WOULD LEAD TO XP_CMDSHELL() which can give the intruder access to the server and even your network.</p>
</div></text><author><a href="/users/23667/saif-khan">Saif Khan</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>That is a hex string. When you translate it, it translates into: "WAITFOR DELAY '00:00:15'"</p>
</div></text><author><a href="/users/98094/icemanind">Icemanind</a></author><comments/></answer></answers></post>