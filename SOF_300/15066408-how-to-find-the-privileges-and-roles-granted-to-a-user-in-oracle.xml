<?xml version="1.0" encoding="utf-8"?>
<post><title>security - How to find the privileges and roles granted to a user in Oracle? - Stack Overflow</title><question><text><div class="post-text" itemprop="text">
<p>I am using Linux, Oracle10g.
I have created one user called test. and granted create session and select any dictionary permission to the same user.</p>
<p>i also granted sysdba and sysoper roles to the same users.</p>
<p>Now i want to display all the privileges and roles granted to the user. 
I found following query but it shows only create session and select dictionary privileges.</p>
<pre class="lang-sql prettyprint prettyprinted" style=""><code><span class="kwd">select</span><span class="pln"> privilege 
</span><span class="kwd">from</span><span class="pln"> dba_sys_privs 
</span><span class="kwd">where</span><span class="pln"> grantee</span><span class="pun">=</span><span class="str">'SAMPLE'</span><span class="pln"> 
</span><span class="kwd">order</span><span class="pln"> </span><span class="kwd">by</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span></code></pre>
<p>please help to resolve the issue.</p>
<p>Thanks</p>
</div></text><author><a href="/users/146325/apc">APC</a></author><comments><comment><text><span class="comment-copy">You can use <a href="http://stackoverflow.com/documentation/oracle/7347/data-dictionary#t=201610091552406899855">Data Dictionary Documentation</a></span></text><author><a class="comment-user" href="/users/3001523/slava-babin" title="341 reputation">Slava Babin</a></author></comment></comments></question><answers><answer><text><div class="post-text" itemprop="text">
<p>Look at <a href="http://docs.oracle.com/cd/B10501_01/server.920/a96521/privs.htm#15665" rel="noreferrer">http://docs.oracle.com/cd/B10501_01/server.920/a96521/privs.htm#15665</a></p>
<p>Check USER_SYS_PRIVS, USER_TAB_PRIVS, USER_ROLE_PRIVS tables.</p>
</div></text><author><a href="/users/1921460/vav">VAV</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>In addition to VAV's answer, The first one was most useful in my environment</p>
<pre class="lang-sql prettyprint prettyprinted" style=""><code><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> USER_ROLE_PRIVS </span><span class="kwd">where</span><span class="pln"> USERNAME</span><span class="pun">=</span><span class="str">'SAMPLE'</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> USER_TAB_PRIVS </span><span class="kwd">where</span><span class="pln"> Grantee </span><span class="pun">=</span><span class="pln"> </span><span class="str">'SAMPLE'</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> USER_SYS_PRIVS </span><span class="kwd">where</span><span class="pln"> USERNAME </span><span class="pun">=</span><span class="pln"> </span><span class="str">'SAMPLE'</span><span class="pun">;</span></code></pre>
</div></text><author><a href="/users/2668478/user2668478">user2668478</a></author><comments><comment><text><span class="comment-copy">+1 very complete. Put "user" instead of sample to get info on current logged user</span></text><author><a class="comment-user" href="/users/75540/daitangio" title="493 reputation">daitangio</a></author></comment><comment><text><span class="comment-copy">Note: if you're using <code>dba_XXX_privs</code>, the column name is <code>grantee</code> instead of <code>username</code>.</span></text><author><a class="comment-user" href="/users/477563/mr-llama" title="13,787 reputation">Mr. Llama</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>None of the other answers worked for me so I wrote my own solution:</p>
<p><strong>As of Oracle 11g.</strong></p>
<p>Replace USER with the desired username</p>
<p><strong>Granted Roles:</strong></p>
<pre class="lang-sql prettyprint prettyprinted" style=""><code><span class="kwd">SELECT</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> 
  </span><span class="kwd">FROM</span><span class="pln"> DBA_ROLE_PRIVS 
 </span><span class="kwd">WHERE</span><span class="pln"> GRANTEE </span><span class="pun">=</span><span class="pln"> </span><span class="str">'USER'</span><span class="pun">;</span></code></pre>
<p><strong>Privileges Granted Directly To User:</strong></p>
<pre class="lang-sql prettyprint prettyprinted" style=""><code><span class="kwd">SELECT</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> 
  </span><span class="kwd">FROM</span><span class="pln"> DBA_TAB_PRIVS 
 </span><span class="kwd">WHERE</span><span class="pln"> GRANTEE </span><span class="pun">=</span><span class="pln"> </span><span class="str">'USER'</span><span class="pun">;</span></code></pre>
<p><strong>Privileges Granted to Role Granted to User:</strong></p>
<pre class="lang-sql prettyprint prettyprinted" style=""><code><span class="kwd">SELECT</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> 
  </span><span class="kwd">FROM</span><span class="pln"> DBA_TAB_PRIVS  
 </span><span class="kwd">WHERE</span><span class="pln"> GRANTEE </span><span class="kwd">IN</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">SELECT</span><span class="pln"> granted_role 
                     </span><span class="kwd">FROM</span><span class="pln"> DBA_ROLE_PRIVS 
                    </span><span class="kwd">WHERE</span><span class="pln"> GRANTEE </span><span class="pun">=</span><span class="pln"> </span><span class="str">'USER'</span><span class="pun">);</span></code></pre>
<p><strong>Granted System Privileges:</strong></p>
<pre class="lang-sql prettyprint prettyprinted" style=""><code><span class="kwd">SELECT</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> 
  </span><span class="kwd">FROM</span><span class="pln"> DBA_SYS_PRIVS 
 </span><span class="kwd">WHERE</span><span class="pln"> GRANTEE </span><span class="pun">=</span><span class="pln"> </span><span class="str">'USER'</span><span class="pun">;</span></code></pre>
<p>If you want to lookup for the user you are currently connected as, you can replace DBA in the table name with USER and remove the WHERE clause.</p>
</div></text><author><a href="/users/3471144/mocking">Mocking</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>IF privileges are given to a user through some roles, then below SQL can be used</p>
<pre class="lang-sql prettyprint prettyprinted" style=""><code><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> ROLE_ROLE_PRIVS </span><span class="kwd">where</span><span class="pln"> ROLE </span><span class="pun">=</span><span class="pln"> </span><span class="str">'ROLE_NAME'</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> ROLE_TAB_PRIVS  </span><span class="kwd">where</span><span class="pln"> ROLE </span><span class="pun">=</span><span class="pln"> </span><span class="str">'ROLE_NAME'</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> ROLE_SYS_PRIVS  </span><span class="kwd">where</span><span class="pln"> ROLE </span><span class="pun">=</span><span class="pln"> </span><span class="str">'ROLE_NAME'</span><span class="pun">;</span></code></pre>
</div></text><author><a href="/users/451894/upog">upog</a></author><comments><comment><text><span class="comment-copy">very helpful to dig deeper when u have rights provided via roles.. Second query helped me alot to check if one our table access right is provided to me.</span></text><author><a class="comment-user" href="/users/1406510/nanosoft" title="612 reputation">nanosoft</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<pre class="lang-sql prettyprint prettyprinted" style=""><code><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> 
</span><span class="kwd">from</span><span class="pln"> ROLE_TAB_PRIVS 
</span><span class="kwd">where</span><span class="pln"> role </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">(</span><span class="pln">
    </span><span class="kwd">select</span><span class="pln"> granted_role
    </span><span class="kwd">from</span><span class="pln"> dba_role_privs 
    </span><span class="kwd">where</span><span class="pln"> granted_role </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">(</span><span class="str">'ROLE1'</span><span class="pun">,</span><span class="str">'ROLE2'</span><span class="pun">)</span><span class="pln">
</span><span class="pun">)</span></code></pre>
</div></text><author><a href="/users/3197422/shans">shans</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>Combining the earlier suggestions to determine your personal permissions (ie 'USER' permissions), then use this:</p>
<pre class="lang-sql prettyprint prettyprinted" style=""><code><span class="com">-- your permissions</span><span class="pln">
</span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> USER_ROLE_PRIVS </span><span class="kwd">where</span><span class="pln"> USERNAME</span><span class="pun">=</span><span class="pln"> </span><span class="kwd">USER</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> USER_TAB_PRIVS </span><span class="kwd">where</span><span class="pln"> Grantee </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">USER</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> USER_SYS_PRIVS </span><span class="kwd">where</span><span class="pln"> USERNAME </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">USER</span><span class="pun">;</span><span class="pln">

</span><span class="com">-- granted role permissions</span><span class="pln">
</span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> ROLE_ROLE_PRIVS </span><span class="kwd">where</span><span class="pln"> ROLE </span><span class="kwd">IN</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">select</span><span class="pln"> granted_role </span><span class="kwd">from</span><span class="pln"> USER_ROLE_PRIVS </span><span class="kwd">where</span><span class="pln"> USERNAME</span><span class="pun">=</span><span class="pln"> </span><span class="kwd">USER</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> ROLE_TAB_PRIVS  </span><span class="kwd">where</span><span class="pln"> ROLE </span><span class="kwd">IN</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">select</span><span class="pln"> granted_role </span><span class="kwd">from</span><span class="pln"> USER_ROLE_PRIVS </span><span class="kwd">where</span><span class="pln"> USERNAME</span><span class="pun">=</span><span class="pln"> </span><span class="kwd">USER</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> ROLE_SYS_PRIVS  </span><span class="kwd">where</span><span class="pln"> ROLE </span><span class="kwd">IN</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">select</span><span class="pln"> granted_role </span><span class="kwd">from</span><span class="pln"> USER_ROLE_PRIVS </span><span class="kwd">where</span><span class="pln"> USERNAME</span><span class="pun">=</span><span class="pln"> </span><span class="kwd">USER</span><span class="pun">);</span></code></pre>
</div></text><author><a href="/users/5499355/shamrockcs">ShamrockCS</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>always make SQL re-usuable: -:)</p>
<pre class="lang-sql prettyprint prettyprinted" style=""><code><span class="com">-- ===================================================</span><span class="pln">
</span><span class="com">-- &amp;role_name will be "enter value for 'role_name'".</span><span class="pln">
</span><span class="com">-- Date:  2015 NOV 11.</span><span class="pln">

</span><span class="com">-- sample code:   define role_name=&amp;role_name</span><span class="pln">
</span><span class="com">-- sample code:   where role like '%&amp;&amp;role_name%'</span><span class="pln">
</span><span class="com">-- ===================================================</span><span class="pln">


define role_name</span><span class="pun">=&amp;</span><span class="pln">role_name

</span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> ROLE_ROLE_PRIVS </span><span class="kwd">where</span><span class="pln"> ROLE </span><span class="pun">=</span><span class="pln"> </span><span class="str">'&amp;&amp;role_name'</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> ROLE_SYS_PRIVS  </span><span class="kwd">where</span><span class="pln"> ROLE </span><span class="pun">=</span><span class="pln"> </span><span class="str">'&amp;&amp;role_name'</span><span class="pun">;</span><span class="pln">


</span><span class="kwd">select</span><span class="pln"> role</span><span class="pun">,</span><span class="pln"> privilege</span><span class="pun">,</span><span class="pln">count</span><span class="pun">(*)</span><span class="pln">
 </span><span class="kwd">from</span><span class="pln"> ROLE_TAB_PRIVS
</span><span class="kwd">where</span><span class="pln"> ROLE </span><span class="pun">=</span><span class="pln"> </span><span class="str">'&amp;&amp;role_name'</span><span class="pln">
</span><span class="kwd">group</span><span class="pln"> </span><span class="kwd">by</span><span class="pln"> role</span><span class="pun">,</span><span class="pln"> privilege
</span><span class="kwd">order</span><span class="pln"> </span><span class="kwd">by</span><span class="pln"> role</span><span class="pun">,</span><span class="pln"> privilege </span><span class="kwd">asc</span><span class="pln">
</span><span class="pun">;</span></code></pre>
</div></text><author><a href="/users/992022/dave">dave</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<pre class="lang-sql prettyprint prettyprinted" style=""><code><span class="kwd">SELECT</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> 
</span><span class="kwd">FROM</span><span class="pln"> DBA_ROLE_PRIVS 
</span><span class="kwd">WHERE</span><span class="pln"> UPPER</span><span class="pun">(</span><span class="pln">GRANTEE</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">LIKE</span><span class="pln"> </span><span class="str">'%XYZ%'</span><span class="pun">;</span></code></pre>
</div></text><author><a href="/users/2615480/user2615480">user2615480</a></author><comments><comment><text><span class="comment-copy">Hi... Why should we use like if we know exact name. LIKE makes query costly....</span></text><author><a class="comment-user" href="/users/2963474/avrajit" title="140 reputation">Avrajit</a></author></comment></comments></answer></answers></post>