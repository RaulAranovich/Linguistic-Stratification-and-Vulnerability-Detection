<?xml version="1.0" encoding="utf-8"?>
<post><title>java - How to retrieve a file from a server via SFTP? - Stack Overflow</title><question><text><div class="post-text" itemprop="text">
<p>I'm trying to retrieve a file from a server using SFTP (as opposed to FTPS) using Java. How can I do this?</p>
</div></text><author><a href="/users/2756409/tylerh">TylerH</a></author><comments/></question><answers><answer><text><div class="post-text" itemprop="text">
<p>Another option is to consider looking at the <a href="http://www.jcraft.com/jsch/" rel="noreferrer" title="JSch library">JSch library</a>. JSch seems to be the preferred library for a few large open source projects, including Eclipse, Ant and Apache Commons HttpClient, amongst others.</p>
<p>It supports both user/pass and certificate-based logins nicely, as well as all a whole host  of other yummy SSH2 features.</p>
<p>Here's a simple remote file retrieve over SFTP. Error handling is left as an exercise for the reader :-)</p>
<pre class="lang-java prettyprint prettyprinted" style=""><code><span class="typ">JSch</span><span class="pln"> jsch </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">JSch</span><span class="pun">();</span><span class="pln">

</span><span class="typ">String</span><span class="pln"> knownHostsFilename </span><span class="pun">=</span><span class="pln"> </span><span class="str">"/home/username/.ssh/known_hosts"</span><span class="pun">;</span><span class="pln">
jsch</span><span class="pun">.</span><span class="pln">setKnownHosts</span><span class="pun">(</span><span class="pln"> knownHostsFilename </span><span class="pun">);</span><span class="pln">

</span><span class="typ">Session</span><span class="pln"> session </span><span class="pun">=</span><span class="pln"> jsch</span><span class="pun">.</span><span class="pln">getSession</span><span class="pun">(</span><span class="pln"> </span><span class="str">"remote-username"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"remote-host"</span><span class="pln"> </span><span class="pun">);</span><span class="pln">    
</span><span class="pun">{</span><span class="pln">
  </span><span class="com">// "interactive" version</span><span class="pln">
  </span><span class="com">// can selectively update specified known_hosts file </span><span class="pln">
  </span><span class="com">// need to implement UserInfo interface</span><span class="pln">
  </span><span class="com">// MyUserInfo is a swing implementation provided in </span><span class="pln">
  </span><span class="com">//  examples/Sftp.java in the JSch dist</span><span class="pln">
  </span><span class="typ">UserInfo</span><span class="pln"> ui </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MyUserInfo</span><span class="pun">();</span><span class="pln">
  session</span><span class="pun">.</span><span class="pln">setUserInfo</span><span class="pun">(</span><span class="pln">ui</span><span class="pun">);</span><span class="pln">

  </span><span class="com">// OR non-interactive version. Relies in host key being in known-hosts file</span><span class="pln">
  session</span><span class="pun">.</span><span class="pln">setPassword</span><span class="pun">(</span><span class="pln"> </span><span class="str">"remote-password"</span><span class="pln"> </span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

session</span><span class="pun">.</span><span class="pln">connect</span><span class="pun">();</span><span class="pln">

</span><span class="typ">Channel</span><span class="pln"> channel </span><span class="pun">=</span><span class="pln"> session</span><span class="pun">.</span><span class="pln">openChannel</span><span class="pun">(</span><span class="pln"> </span><span class="str">"sftp"</span><span class="pln"> </span><span class="pun">);</span><span class="pln">
channel</span><span class="pun">.</span><span class="pln">connect</span><span class="pun">();</span><span class="pln">

</span><span class="typ">ChannelSftp</span><span class="pln"> sftpChannel </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ChannelSftp</span><span class="pun">)</span><span class="pln"> channel</span><span class="pun">;</span><span class="pln">

sftpChannel</span><span class="pun">.</span><span class="pln">get</span><span class="pun">(</span><span class="str">"remote-file"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"local-file"</span><span class="pln"> </span><span class="pun">);</span><span class="pln">
</span><span class="com">// OR</span><span class="pln">
</span><span class="typ">InputStream</span><span class="pln"> in </span><span class="pun">=</span><span class="pln"> sftpChannel</span><span class="pun">.</span><span class="pln">get</span><span class="pun">(</span><span class="pln"> </span><span class="str">"remote-file"</span><span class="pln"> </span><span class="pun">);</span><span class="pln">
  </span><span class="com">// process inputstream as needed</span><span class="pln">

sftpChannel</span><span class="pun">.</span><span class="pln">exit</span><span class="pun">();</span><span class="pln">
session</span><span class="pun">.</span><span class="pln">disconnect</span><span class="pun">();</span></code></pre>
</div></text><author><a href="/users/1820/cheekysoft">Cheekysoft</a></author><comments><comment><text><span class="comment-copy">Cheekysoft,    I noticed - while using Jsch - removing files on the sftp-server does not work. Also renaming files does not work too.    Any ideas please???    Andy</span></text><author><span class="comment-user">user283062</span></author></comment><comment><text><span class="comment-copy">Sorry, it is not something i work with at the moment. (Please try and leave these sort of responses as comments -- like this message -- and not as a new answer to the original question)</span></text><author><a class="comment-user" href="/users/1820/cheekysoft" title="23,093 reputation">Cheekysoft</a></author></comment><comment><text><span class="comment-copy">What is that code block after the assignment of session? Is that some fancy Java syntax I've never seen? If so - what does it accomplish being written that way?</span></text><author><a class="comment-user" href="/users/211614/michael-peterson" title="5,097 reputation">Michael Peterson</a></author></comment><comment><text><span class="comment-copy">@p1x3l5 standard java syntax allows a block to be inserted anywhere; it can be used to provide finer control over variable scope, if you wish. However, in this case, it is just a visual aid to help indicate the two implementation choices: either use the interactive version which requests a password from the user,  or use a hardcoded password requiring no user intervention but arguably an additional security risk.</span></text><author><a class="comment-user" href="/users/1820/cheekysoft" title="23,093 reputation">Cheekysoft</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>Here is the complete source code of an example using <a href="http://www.jcraft.com/jsch/" rel="noreferrer">JSch</a> without having to worry about the ssh key checking.</p>
<pre class="lang-java prettyprint prettyprinted" style=""><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">jcraft</span><span class="pun">.</span><span class="pln">jsch</span><span class="pun">.*;</span><span class="pln">

</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">TestJSch</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> args</span><span class="pun">[])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="typ">JSch</span><span class="pln"> jsch </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">JSch</span><span class="pun">();</span><span class="pln">
        </span><span class="typ">Session</span><span class="pln"> session </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">try</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            session </span><span class="pun">=</span><span class="pln"> jsch</span><span class="pun">.</span><span class="pln">getSession</span><span class="pun">(</span><span class="str">"username"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"127.0.0.1"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">22</span><span class="pun">);</span><span class="pln">
            session</span><span class="pun">.</span><span class="pln">setConfig</span><span class="pun">(</span><span class="str">"StrictHostKeyChecking"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"no"</span><span class="pun">);</span><span class="pln">
            session</span><span class="pun">.</span><span class="pln">setPassword</span><span class="pun">(</span><span class="str">"password"</span><span class="pun">);</span><span class="pln">
            session</span><span class="pun">.</span><span class="pln">connect</span><span class="pun">();</span><span class="pln">

            </span><span class="typ">Channel</span><span class="pln"> channel </span><span class="pun">=</span><span class="pln"> session</span><span class="pun">.</span><span class="pln">openChannel</span><span class="pun">(</span><span class="str">"sftp"</span><span class="pun">);</span><span class="pln">
            channel</span><span class="pun">.</span><span class="pln">connect</span><span class="pun">();</span><span class="pln">
            </span><span class="typ">ChannelSftp</span><span class="pln"> sftpChannel </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ChannelSftp</span><span class="pun">)</span><span class="pln"> channel</span><span class="pun">;</span><span class="pln">
            sftpChannel</span><span class="pun">.</span><span class="pln">get</span><span class="pun">(</span><span class="str">"remotefile.txt"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"localfile.txt"</span><span class="pun">);</span><span class="pln">
            sftpChannel</span><span class="pun">.</span><span class="pln">exit</span><span class="pun">();</span><span class="pln">
            session</span><span class="pun">.</span><span class="pln">disconnect</span><span class="pun">();</span><span class="pln">
        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">catch</span><span class="pln"> </span><span class="pun">(</span><span class="typ">JSchException</span><span class="pln"> e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            e</span><span class="pun">.</span><span class="pln">printStackTrace</span><span class="pun">();</span><span class="pln">  
        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">catch</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SftpException</span><span class="pln"> e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            e</span><span class="pun">.</span><span class="pln">printStackTrace</span><span class="pun">();</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div></text><author><a href="/users/172467/iraklis">Iraklis</a></author><comments><comment><text><span class="comment-copy">A <code>finally</code> block should be used to include the channel clean-up code, to ensure that it always runs.</span></text><author><a class="comment-user" href="/users/490873/hotshot309" title="1,370 reputation">hotshot309</a></author></comment><comment><text><span class="comment-copy">I'm getting this exception now:  <code>com.jcraft.jsch.JSchException: Session.connect: java.security.InvalidAlgorithmParameterException: Prime size must be multiple of 64, and can only range from 512 to 2048 (inclusive)</code></span></text><author><a class="comment-user" href="/users/584947/anon58192932" title="1,359 reputation">anon58192932</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>Below is an example using Apache Common VFS:</p>
<pre class="lang-java prettyprint prettyprinted" style=""><code><span class="typ">FileSystemOptions</span><span class="pln"> fsOptions </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileSystemOptions</span><span class="pun">();</span><span class="pln">
</span><span class="typ">SftpFileSystemConfigBuilder</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">().</span><span class="pln">setStrictHostKeyChecking</span><span class="pun">(</span><span class="pln">fsOptions</span><span class="pun">,</span><span class="pln"> </span><span class="str">"no"</span><span class="pun">);</span><span class="pln">
</span><span class="typ">FileSystemManager</span><span class="pln"> fsManager </span><span class="pun">=</span><span class="pln"> VFS</span><span class="pun">.</span><span class="pln">getManager</span><span class="pun">();</span><span class="pln">
</span><span class="typ">String</span><span class="pln"> uri </span><span class="pun">=</span><span class="pln"> </span><span class="str">"sftp://user:password@host:port/absolute-path"</span><span class="pun">;</span><span class="pln">
</span><span class="typ">FileObject</span><span class="pln"> fo </span><span class="pun">=</span><span class="pln"> fsManager</span><span class="pun">.</span><span class="pln">resolveFile</span><span class="pun">(</span><span class="pln">uri</span><span class="pun">,</span><span class="pln"> fsOptions</span><span class="pun">);</span></code></pre>
</div></text><author><a href="/users/165119/chris-j">Chris J</a></author><comments><comment><text><span class="comment-copy">Another nice thing to do is to set the timeout, so that if the remote system is offline, you don't hang there forever.  You can do this just like was done for the host key check disable:  SftpFileSystemConfigBuilder.getInstance().setTimeout(fsOptio‌​ns, 5000);</span></text><author><a class="comment-user" href="/users/118288/scott-jones" title="159 reputation">Scott Jones</a></author></comment><comment><text><span class="comment-copy">I'm using Apache VFS with OtrosVfsBrowser (<a href="http://code.google.com/p/otrosvfsbrowser/" rel="nofollow noreferrer">code.google.com/p/otrosvfsbrowser</a>)</span></text><author><a class="comment-user" href="/users/514687/krzyh" title="3,003 reputation">KrzyH</a></author></comment><comment><text><span class="comment-copy">How would you advise close this connection when using multiple SFTP clients at the same time ?</span></text><author><a class="comment-user" href="/users/4961391/francy" title="217 reputation">Francy</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>This was the solution I came up with
<a href="http://sourceforge.net/projects/sshtools/" rel="noreferrer">http://sourceforge.net/projects/sshtools/</a> (most error handling omitted for clarity). This is an excerpt from <a href="http://www.spindriftpages.net/blog/dave/2007/11/27/sshtools-j2ssh-java-sshsftp-library" rel="noreferrer">my blog</a></p>
<pre class="lang-java prettyprint prettyprinted" style=""><code><span class="typ">SshClient</span><span class="pln"> ssh </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SshClient</span><span class="pun">();</span><span class="pln">
ssh</span><span class="pun">.</span><span class="pln">connect</span><span class="pun">(</span><span class="pln">host</span><span class="pun">,</span><span class="pln"> port</span><span class="pun">);</span><span class="pln">
</span><span class="com">//Authenticate</span><span class="pln">
</span><span class="typ">PasswordAuthenticationClient</span><span class="pln"> passwordAuthenticationClient </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PasswordAuthenticationClient</span><span class="pun">();</span><span class="pln">
passwordAuthenticationClient</span><span class="pun">.</span><span class="pln">setUsername</span><span class="pun">(</span><span class="pln">userName</span><span class="pun">);</span><span class="pln">
passwordAuthenticationClient</span><span class="pun">.</span><span class="pln">setPassword</span><span class="pun">(</span><span class="pln">password</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> result </span><span class="pun">=</span><span class="pln"> ssh</span><span class="pun">.</span><span class="pln">authenticate</span><span class="pun">(</span><span class="pln">passwordAuthenticationClient</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">result </span><span class="pun">!=</span><span class="pln"> </span><span class="typ">AuthenticationProtocolState</span><span class="pun">.</span><span class="pln">COMPLETE</span><span class="pun">){</span><span class="pln">
     </span><span class="kwd">throw</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SFTPException</span><span class="pun">(</span><span class="str">"Login to "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> host </span><span class="pun">+</span><span class="pln"> </span><span class="str">":"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> port </span><span class="pun">+</span><span class="pln"> </span><span class="str">" "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> userName </span><span class="pun">+</span><span class="pln"> </span><span class="str">"/"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> password </span><span class="pun">+</span><span class="pln"> </span><span class="str">" failed"</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="com">//Open the SFTP channel</span><span class="pln">
</span><span class="typ">SftpClient</span><span class="pln"> client </span><span class="pun">=</span><span class="pln"> ssh</span><span class="pun">.</span><span class="pln">openSftpClient</span><span class="pun">();</span><span class="pln">
</span><span class="com">//Send the file</span><span class="pln">
client</span><span class="pun">.</span><span class="pln">put</span><span class="pun">(</span><span class="pln">filePath</span><span class="pun">);</span><span class="pln">
</span><span class="com">//disconnect</span><span class="pln">
client</span><span class="pun">.</span><span class="pln">quit</span><span class="pun">();</span><span class="pln">
ssh</span><span class="pun">.</span><span class="pln">disconnect</span><span class="pun">();</span></code></pre>
</div></text><author><a href="/users/1769/david-hayes">David Hayes</a></author><comments><comment><text><span class="comment-copy">j2ssh is pretty buggy</span></text><author><a class="comment-user" href="/users/109114/bruce-blackshaw" title="862 reputation">Bruce Blackshaw</a></author></comment><comment><text><span class="comment-copy">I agree (belatedly), it worked fine for the original site/download I required but it refuesed to work for the new one. I'm in the process of switching to JSch</span></text><author><a class="comment-user owner" href="/users/1769/david-hayes" title="3,662 reputation">David Hayes</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>A nice abstraction on top of Jsch is Apache <a href="http://commons.apache.org/vfs/" rel="noreferrer">commons-vfs</a> which offers a virtual filesystem API that makes accessing and writing SFTP files almost transparent. Worked well for us.</p>
</div></text><author><a href="/users/1996/boris-terzic">Boris Terzic</a></author><comments><comment><text><span class="comment-copy">is it possible to use pre-shared keys in combination with commons-vfs?</span></text><author><a class="comment-user" href="/users/4308/benedikt-waldvogel" title="6,722 reputation">Benedikt Waldvogel</a></author></comment><comment><text><span class="comment-copy">Yes it is. If you need non-standard identities you can call             SftpFileSystemConfigBuilder.getInstance().setIdentities(...)‌​.</span></text><author><a class="comment-user" href="/users/95361/russ-hayward" title="4,971 reputation">Russ Hayward</a></author></comment><comment><text><span class="comment-copy">You can use pre-shared keys. But this keys have to be without password. OtrosLogViewer is using SSH key authorization with VFS but requires to remove passphrase from key (<a href="http://code.google.com/p/otroslogviewer/wiki/SftpAuthPubKey" rel="nofollow noreferrer">code.google.com/p/otroslogviewer/wiki/SftpAuthPubKey</a>)</span></text><author><a class="comment-user" href="/users/514687/krzyh" title="3,003 reputation">KrzyH</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<blockquote>
<p>Apache Commons SFTP library</p>
</blockquote>
<p><strong>Common java properties file for all the examples</strong></p>
<p>serverAddress=111.222.333.444</p>
<p>userId=myUserId</p>
<p>password=myPassword</p>
<p>remoteDirectory=products/   </p>
<p>localDirectory=import/</p>
<blockquote>
<p>Upload file to remote server using SFTP</p>
</blockquote>
<pre class="lang-java prettyprint prettyprinted" style=""><code><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">File</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">FileInputStream</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">Properties</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">import</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">apache</span><span class="pun">.</span><span class="pln">commons</span><span class="pun">.</span><span class="pln">vfs2</span><span class="pun">.</span><span class="typ">FileObject</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">apache</span><span class="pun">.</span><span class="pln">commons</span><span class="pun">.</span><span class="pln">vfs2</span><span class="pun">.</span><span class="typ">FileSystemOptions</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">apache</span><span class="pun">.</span><span class="pln">commons</span><span class="pun">.</span><span class="pln">vfs2</span><span class="pun">.</span><span class="typ">Selectors</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">apache</span><span class="pun">.</span><span class="pln">commons</span><span class="pun">.</span><span class="pln">vfs2</span><span class="pun">.</span><span class="pln">impl</span><span class="pun">.</span><span class="typ">StandardFileSystemManager</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">apache</span><span class="pun">.</span><span class="pln">commons</span><span class="pun">.</span><span class="pln">vfs2</span><span class="pun">.</span><span class="pln">provider</span><span class="pun">.</span><span class="pln">sftp</span><span class="pun">.</span><span class="typ">SftpFileSystemConfigBuilder</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">SendMyFiles</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

 </span><span class="kwd">static</span><span class="pln"> </span><span class="typ">Properties</span><span class="pln"> props</span><span class="pun">;</span><span class="pln">

 </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="typ">SendMyFiles</span><span class="pln"> sendMyFiles </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SendMyFiles</span><span class="pun">();</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">args</span><span class="pun">.</span><span class="pln">length </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">{</span><span class="pln">
   </span><span class="typ">System</span><span class="pun">.</span><span class="pln">err</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"Usage: java "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> sendMyFiles</span><span class="pun">.</span><span class="pln">getClass</span><span class="pun">().</span><span class="pln">getName</span><span class="pun">()+</span><span class="pln">
     </span><span class="str">" Properties_file File_To_FTP "</span><span class="pun">);</span><span class="pln">
   </span><span class="typ">System</span><span class="pun">.</span><span class="pln">exit</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="typ">String</span><span class="pln"> propertiesFile </span><span class="pun">=</span><span class="pln"> args</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
  </span><span class="typ">String</span><span class="pln"> fileToFTP </span><span class="pun">=</span><span class="pln"> args</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
  sendMyFiles</span><span class="pun">.</span><span class="pln">startFTP</span><span class="pun">(</span><span class="pln">propertiesFile</span><span class="pun">,</span><span class="pln"> fileToFTP</span><span class="pun">);</span><span class="pln">

 </span><span class="pun">}</span><span class="pln">

 </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> startFTP</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> propertiesFilename</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> fileToFTP</span><span class="pun">){</span><span class="pln">

  props </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Properties</span><span class="pun">();</span><span class="pln">
  </span><span class="typ">StandardFileSystemManager</span><span class="pln"> manager </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">StandardFileSystemManager</span><span class="pun">();</span><span class="pln">

  </span><span class="kwd">try</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

   props</span><span class="pun">.</span><span class="pln">load</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileInputStream</span><span class="pun">(</span><span class="str">"properties/"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> propertiesFilename</span><span class="pun">));</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> serverAddress </span><span class="pun">=</span><span class="pln"> props</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"serverAddress"</span><span class="pun">).</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> userId </span><span class="pun">=</span><span class="pln"> props</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"userId"</span><span class="pun">).</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> password </span><span class="pun">=</span><span class="pln"> props</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"password"</span><span class="pun">).</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> remoteDirectory </span><span class="pun">=</span><span class="pln"> props</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"remoteDirectory"</span><span class="pun">).</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> localDirectory </span><span class="pun">=</span><span class="pln"> props</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"localDirectory"</span><span class="pun">).</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">

   </span><span class="com">//check if the file exists</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> filepath </span><span class="pun">=</span><span class="pln"> localDirectory </span><span class="pun">+</span><span class="pln">  fileToFTP</span><span class="pun">;</span><span class="pln">
   </span><span class="typ">File</span><span class="pln"> file </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">File</span><span class="pun">(</span><span class="pln">filepath</span><span class="pun">);</span><span class="pln">
   </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">file</span><span class="pun">.</span><span class="pln">exists</span><span class="pun">())</span><span class="pln">
    </span><span class="kwd">throw</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RuntimeException</span><span class="pun">(</span><span class="str">"Error. Local file not found"</span><span class="pun">);</span><span class="pln">

   </span><span class="com">//Initializes the file manager</span><span class="pln">
   manager</span><span class="pun">.</span><span class="pln">init</span><span class="pun">();</span><span class="pln">

   </span><span class="com">//Setup our SFTP configuration</span><span class="pln">
   </span><span class="typ">FileSystemOptions</span><span class="pln"> opts </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileSystemOptions</span><span class="pun">();</span><span class="pln">
   </span><span class="typ">SftpFileSystemConfigBuilder</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">().</span><span class="pln">setStrictHostKeyChecking</span><span class="pun">(</span><span class="pln">
     opts</span><span class="pun">,</span><span class="pln"> </span><span class="str">"no"</span><span class="pun">);</span><span class="pln">
   </span><span class="typ">SftpFileSystemConfigBuilder</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">().</span><span class="pln">setUserDirIsRoot</span><span class="pun">(</span><span class="pln">opts</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">);</span><span class="pln">
   </span><span class="typ">SftpFileSystemConfigBuilder</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">().</span><span class="pln">setTimeout</span><span class="pun">(</span><span class="pln">opts</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10000</span><span class="pun">);</span><span class="pln">

   </span><span class="com">//Create the SFTP URI using the host name, userid, password,  remote path and file name</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> sftpUri </span><span class="pun">=</span><span class="pln"> </span><span class="str">"sftp://"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> userId </span><span class="pun">+</span><span class="pln"> </span><span class="str">":"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> password </span><span class="pun">+</span><span class="pln">  </span><span class="str">"@"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> serverAddress </span><span class="pun">+</span><span class="pln"> </span><span class="str">"/"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> 
     remoteDirectory </span><span class="pun">+</span><span class="pln"> fileToFTP</span><span class="pun">;</span><span class="pln">

   </span><span class="com">// Create local file object</span><span class="pln">
   </span><span class="typ">FileObject</span><span class="pln"> localFile </span><span class="pun">=</span><span class="pln"> manager</span><span class="pun">.</span><span class="pln">resolveFile</span><span class="pun">(</span><span class="pln">file</span><span class="pun">.</span><span class="pln">getAbsolutePath</span><span class="pun">());</span><span class="pln">

   </span><span class="com">// Create remote file object</span><span class="pln">
   </span><span class="typ">FileObject</span><span class="pln"> remoteFile </span><span class="pun">=</span><span class="pln"> manager</span><span class="pun">.</span><span class="pln">resolveFile</span><span class="pun">(</span><span class="pln">sftpUri</span><span class="pun">,</span><span class="pln"> opts</span><span class="pun">);</span><span class="pln">

   </span><span class="com">// Copy local file to sftp server</span><span class="pln">
   remoteFile</span><span class="pun">.</span><span class="pln">copyFrom</span><span class="pun">(</span><span class="pln">localFile</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Selectors</span><span class="pun">.</span><span class="pln">SELECT_SELF</span><span class="pun">);</span><span class="pln">
   </span><span class="typ">System</span><span class="pun">.</span><span class="pln">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"File upload successful"</span><span class="pun">);</span><span class="pln">

  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">catch</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Exception</span><span class="pln"> ex</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
   ex</span><span class="pun">.</span><span class="pln">printStackTrace</span><span class="pun">();</span><span class="pln">
   </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">finally</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
   manager</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
 </span><span class="pun">}</span><span class="pln">


</span><span class="pun">}</span></code></pre>
<blockquote>
<p>Download file from remote server using SFTP</p>
</blockquote>
<pre class="lang-java prettyprint prettyprinted" style=""><code><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">File</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">FileInputStream</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">Properties</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">import</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">apache</span><span class="pun">.</span><span class="pln">commons</span><span class="pun">.</span><span class="pln">vfs2</span><span class="pun">.</span><span class="typ">FileObject</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">apache</span><span class="pun">.</span><span class="pln">commons</span><span class="pun">.</span><span class="pln">vfs2</span><span class="pun">.</span><span class="typ">FileSystemOptions</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">apache</span><span class="pun">.</span><span class="pln">commons</span><span class="pun">.</span><span class="pln">vfs2</span><span class="pun">.</span><span class="typ">Selectors</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">apache</span><span class="pun">.</span><span class="pln">commons</span><span class="pun">.</span><span class="pln">vfs2</span><span class="pun">.</span><span class="pln">impl</span><span class="pun">.</span><span class="typ">StandardFileSystemManager</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">apache</span><span class="pun">.</span><span class="pln">commons</span><span class="pun">.</span><span class="pln">vfs2</span><span class="pun">.</span><span class="pln">provider</span><span class="pun">.</span><span class="pln">sftp</span><span class="pun">.</span><span class="typ">SftpFileSystemConfigBuilder</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">GetMyFiles</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

 </span><span class="kwd">static</span><span class="pln"> </span><span class="typ">Properties</span><span class="pln"> props</span><span class="pun">;</span><span class="pln">

 </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="typ">GetMyFiles</span><span class="pln"> getMyFiles </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GetMyFiles</span><span class="pun">();</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">args</span><span class="pun">.</span><span class="pln">length </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">{</span><span class="pln">
   </span><span class="typ">System</span><span class="pun">.</span><span class="pln">err</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"Usage: java "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> getMyFiles</span><span class="pun">.</span><span class="pln">getClass</span><span class="pun">().</span><span class="pln">getName</span><span class="pun">()+</span><span class="pln">
   </span><span class="str">" Properties_filename File_To_Download "</span><span class="pun">);</span><span class="pln">
   </span><span class="typ">System</span><span class="pun">.</span><span class="pln">exit</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="typ">String</span><span class="pln"> propertiesFilename </span><span class="pun">=</span><span class="pln"> args</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
  </span><span class="typ">String</span><span class="pln"> fileToDownload </span><span class="pun">=</span><span class="pln"> args</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
  getMyFiles</span><span class="pun">.</span><span class="pln">startFTP</span><span class="pun">(</span><span class="pln">propertiesFilename</span><span class="pun">,</span><span class="pln"> fileToDownload</span><span class="pun">);</span><span class="pln">

 </span><span class="pun">}</span><span class="pln">

 </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> startFTP</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> propertiesFilename</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> fileToDownload</span><span class="pun">){</span><span class="pln">

  props </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Properties</span><span class="pun">();</span><span class="pln">
  </span><span class="typ">StandardFileSystemManager</span><span class="pln"> manager </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">StandardFileSystemManager</span><span class="pun">();</span><span class="pln">

  </span><span class="kwd">try</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

   props</span><span class="pun">.</span><span class="pln">load</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileInputStream</span><span class="pun">(</span><span class="str">"properties/"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> propertiesFilename</span><span class="pun">));</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> serverAddress </span><span class="pun">=</span><span class="pln"> props</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"serverAddress"</span><span class="pun">).</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> userId </span><span class="pun">=</span><span class="pln"> props</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"userId"</span><span class="pun">).</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> password </span><span class="pun">=</span><span class="pln"> props</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"password"</span><span class="pun">).</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> remoteDirectory </span><span class="pun">=</span><span class="pln"> props</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"remoteDirectory"</span><span class="pun">).</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> localDirectory </span><span class="pun">=</span><span class="pln"> props</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"localDirectory"</span><span class="pun">).</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">


   </span><span class="com">//Initializes the file manager</span><span class="pln">
   manager</span><span class="pun">.</span><span class="pln">init</span><span class="pun">();</span><span class="pln">

   </span><span class="com">//Setup our SFTP configuration</span><span class="pln">
   </span><span class="typ">FileSystemOptions</span><span class="pln"> opts </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileSystemOptions</span><span class="pun">();</span><span class="pln">
   </span><span class="typ">SftpFileSystemConfigBuilder</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">().</span><span class="pln">setStrictHostKeyChecking</span><span class="pun">(</span><span class="pln">
     opts</span><span class="pun">,</span><span class="pln"> </span><span class="str">"no"</span><span class="pun">);</span><span class="pln">
   </span><span class="typ">SftpFileSystemConfigBuilder</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">().</span><span class="pln">setUserDirIsRoot</span><span class="pun">(</span><span class="pln">opts</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">);</span><span class="pln">
   </span><span class="typ">SftpFileSystemConfigBuilder</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">().</span><span class="pln">setTimeout</span><span class="pun">(</span><span class="pln">opts</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10000</span><span class="pun">);</span><span class="pln">

   </span><span class="com">//Create the SFTP URI using the host name, userid, password,  remote path and file name</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> sftpUri </span><span class="pun">=</span><span class="pln"> </span><span class="str">"sftp://"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> userId </span><span class="pun">+</span><span class="pln"> </span><span class="str">":"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> password </span><span class="pun">+</span><span class="pln">  </span><span class="str">"@"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> serverAddress </span><span class="pun">+</span><span class="pln"> </span><span class="str">"/"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> 
     remoteDirectory </span><span class="pun">+</span><span class="pln"> fileToDownload</span><span class="pun">;</span><span class="pln">

   </span><span class="com">// Create local file object</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> filepath </span><span class="pun">=</span><span class="pln"> localDirectory </span><span class="pun">+</span><span class="pln">  fileToDownload</span><span class="pun">;</span><span class="pln">
   </span><span class="typ">File</span><span class="pln"> file </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">File</span><span class="pun">(</span><span class="pln">filepath</span><span class="pun">);</span><span class="pln">
   </span><span class="typ">FileObject</span><span class="pln"> localFile </span><span class="pun">=</span><span class="pln"> manager</span><span class="pun">.</span><span class="pln">resolveFile</span><span class="pun">(</span><span class="pln">file</span><span class="pun">.</span><span class="pln">getAbsolutePath</span><span class="pun">());</span><span class="pln">

   </span><span class="com">// Create remote file object</span><span class="pln">
   </span><span class="typ">FileObject</span><span class="pln"> remoteFile </span><span class="pun">=</span><span class="pln"> manager</span><span class="pun">.</span><span class="pln">resolveFile</span><span class="pun">(</span><span class="pln">sftpUri</span><span class="pun">,</span><span class="pln"> opts</span><span class="pun">);</span><span class="pln">

   </span><span class="com">// Copy local file to sftp server</span><span class="pln">
   localFile</span><span class="pun">.</span><span class="pln">copyFrom</span><span class="pun">(</span><span class="pln">remoteFile</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Selectors</span><span class="pun">.</span><span class="pln">SELECT_SELF</span><span class="pun">);</span><span class="pln">
   </span><span class="typ">System</span><span class="pun">.</span><span class="pln">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"File download successful"</span><span class="pun">);</span><span class="pln">

  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">catch</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Exception</span><span class="pln"> ex</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
   ex</span><span class="pun">.</span><span class="pln">printStackTrace</span><span class="pun">();</span><span class="pln">
   </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">finally</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
   manager</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
 </span><span class="pun">}</span><span class="pln">

</span><span class="pun">}</span></code></pre>
<blockquote>
<p>Delete a file on remote server using SFTP</p>
</blockquote>
<pre class="lang-java prettyprint prettyprinted" style=""><code><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">FileInputStream</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">Properties</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">import</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">apache</span><span class="pun">.</span><span class="pln">commons</span><span class="pun">.</span><span class="pln">vfs2</span><span class="pun">.</span><span class="typ">FileObject</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">apache</span><span class="pun">.</span><span class="pln">commons</span><span class="pun">.</span><span class="pln">vfs2</span><span class="pun">.</span><span class="typ">FileSystemOptions</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">apache</span><span class="pun">.</span><span class="pln">commons</span><span class="pun">.</span><span class="pln">vfs2</span><span class="pun">.</span><span class="pln">impl</span><span class="pun">.</span><span class="typ">StandardFileSystemManager</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">apache</span><span class="pun">.</span><span class="pln">commons</span><span class="pun">.</span><span class="pln">vfs2</span><span class="pun">.</span><span class="pln">provider</span><span class="pun">.</span><span class="pln">sftp</span><span class="pun">.</span><span class="typ">SftpFileSystemConfigBuilder</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">DeleteRemoteFile</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

 </span><span class="kwd">static</span><span class="pln"> </span><span class="typ">Properties</span><span class="pln"> props</span><span class="pun">;</span><span class="pln">

 </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="typ">DeleteRemoteFile</span><span class="pln"> getMyFiles </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">DeleteRemoteFile</span><span class="pun">();</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">args</span><span class="pun">.</span><span class="pln">length </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">{</span><span class="pln">
   </span><span class="typ">System</span><span class="pun">.</span><span class="pln">err</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"Usage: java "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> getMyFiles</span><span class="pun">.</span><span class="pln">getClass</span><span class="pun">().</span><span class="pln">getName</span><span class="pun">()+</span><span class="pln">
   </span><span class="str">" Properties_filename File_To_Delete "</span><span class="pun">);</span><span class="pln">
   </span><span class="typ">System</span><span class="pun">.</span><span class="pln">exit</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="typ">String</span><span class="pln"> propertiesFilename </span><span class="pun">=</span><span class="pln"> args</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
  </span><span class="typ">String</span><span class="pln"> fileToDownload </span><span class="pun">=</span><span class="pln"> args</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
  getMyFiles</span><span class="pun">.</span><span class="pln">startFTP</span><span class="pun">(</span><span class="pln">propertiesFilename</span><span class="pun">,</span><span class="pln"> fileToDownload</span><span class="pun">);</span><span class="pln">

 </span><span class="pun">}</span><span class="pln">

 </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> startFTP</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> propertiesFilename</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> fileToDownload</span><span class="pun">){</span><span class="pln">

  props </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Properties</span><span class="pun">();</span><span class="pln">
  </span><span class="typ">StandardFileSystemManager</span><span class="pln"> manager </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">StandardFileSystemManager</span><span class="pun">();</span><span class="pln">

  </span><span class="kwd">try</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

   props</span><span class="pun">.</span><span class="pln">load</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileInputStream</span><span class="pun">(</span><span class="str">"properties/"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> propertiesFilename</span><span class="pun">));</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> serverAddress </span><span class="pun">=</span><span class="pln"> props</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"serverAddress"</span><span class="pun">).</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> userId </span><span class="pun">=</span><span class="pln"> props</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"userId"</span><span class="pun">).</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> password </span><span class="pun">=</span><span class="pln"> props</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"password"</span><span class="pun">).</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> remoteDirectory </span><span class="pun">=</span><span class="pln"> props</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"remoteDirectory"</span><span class="pun">).</span><span class="pln">trim</span><span class="pun">();</span><span class="pln">


   </span><span class="com">//Initializes the file manager</span><span class="pln">
   manager</span><span class="pun">.</span><span class="pln">init</span><span class="pun">();</span><span class="pln">

   </span><span class="com">//Setup our SFTP configuration</span><span class="pln">
   </span><span class="typ">FileSystemOptions</span><span class="pln"> opts </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileSystemOptions</span><span class="pun">();</span><span class="pln">
   </span><span class="typ">SftpFileSystemConfigBuilder</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">().</span><span class="pln">setStrictHostKeyChecking</span><span class="pun">(</span><span class="pln">
     opts</span><span class="pun">,</span><span class="pln"> </span><span class="str">"no"</span><span class="pun">);</span><span class="pln">
   </span><span class="typ">SftpFileSystemConfigBuilder</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">().</span><span class="pln">setUserDirIsRoot</span><span class="pun">(</span><span class="pln">opts</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">);</span><span class="pln">
   </span><span class="typ">SftpFileSystemConfigBuilder</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">().</span><span class="pln">setTimeout</span><span class="pun">(</span><span class="pln">opts</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10000</span><span class="pun">);</span><span class="pln">

   </span><span class="com">//Create the SFTP URI using the host name, userid, password,  remote path and file name</span><span class="pln">
   </span><span class="typ">String</span><span class="pln"> sftpUri </span><span class="pun">=</span><span class="pln"> </span><span class="str">"sftp://"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> userId </span><span class="pun">+</span><span class="pln"> </span><span class="str">":"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> password </span><span class="pun">+</span><span class="pln">  </span><span class="str">"@"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> serverAddress </span><span class="pun">+</span><span class="pln"> </span><span class="str">"/"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> 
     remoteDirectory </span><span class="pun">+</span><span class="pln"> fileToDownload</span><span class="pun">;</span><span class="pln">

   </span><span class="com">//Create remote file object</span><span class="pln">
   </span><span class="typ">FileObject</span><span class="pln"> remoteFile </span><span class="pun">=</span><span class="pln"> manager</span><span class="pun">.</span><span class="pln">resolveFile</span><span class="pun">(</span><span class="pln">sftpUri</span><span class="pun">,</span><span class="pln"> opts</span><span class="pun">);</span><span class="pln">

   </span><span class="com">//Check if the file exists</span><span class="pln">
   </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">remoteFile</span><span class="pun">.</span><span class="pln">exists</span><span class="pun">()){</span><span class="pln">
    remoteFile</span><span class="pun">.</span><span class="kwd">delete</span><span class="pun">();</span><span class="pln">
    </span><span class="typ">System</span><span class="pun">.</span><span class="pln">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"File delete successful"</span><span class="pun">);</span><span class="pln">
   </span><span class="pun">}</span><span class="pln">

  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">catch</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Exception</span><span class="pln"> ex</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
   ex</span><span class="pun">.</span><span class="pln">printStackTrace</span><span class="pun">();</span><span class="pln">
   </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">finally</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
   manager</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
 </span><span class="pun">}</span><span class="pln">

</span><span class="pun">}</span></code></pre>
</div></text><author><a href="/users/185022/az">AZ_</a></author><comments><comment><text><span class="comment-copy">Source: <a href="http://www.mysamplecode.com/2013/06/sftp-apache-commons-file-download.html" rel="nofollow noreferrer">mysamplecode.com/2013/06/sftp-apache-commons-file-download.h‌​tml</a></span></text><author><a class="comment-user" href="/users/185022/az" title="18,194 reputation">AZ_</a></author></comment><comment><text><span class="comment-copy">Very useful code thanks@AZ_</span></text><author><a class="comment-user" href="/users/3016916/m-s-parmar" title="604 reputation">M S Parmar</a></author></comment><comment><text><span class="comment-copy">how to configure while having ssh-key (public key) to copy files on server. Because i need to make ssh_trust between my server and remote server.</span></text><author><a class="comment-user" href="/users/3016916/m-s-parmar" title="604 reputation">M S Parmar</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>There is a nice comparison of the 3 mature Java libraries for SFTP: <a href="https://www.javacodegeeks.com/2015/08/commons-vfs-sshj-and-jsch-in-comparison.html" rel="nofollow">Commons VFS, SSHJ and JSch</a> </p>
<p>To sum up SSHJ has the clearest API and it's the best out of them if you don't need other storages support provided by Commons VFS.</p>
<p>Here is edited SSHJ example from <a href="https://github.com/hierynomus/sshj/blob/master/examples/src/main/java/net/schmizz/sshj/examples/SFTPDownload.java" rel="nofollow">github</a>:</p>
<pre class="lang-java prettyprint prettyprinted" style=""><code><span class="kwd">final</span><span class="pln"> </span><span class="typ">SSHClient</span><span class="pln"> ssh </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SSHClient</span><span class="pun">();</span><span class="pln">
ssh</span><span class="pun">.</span><span class="pln">loadKnownHosts</span><span class="pun">();</span><span class="pln"> </span><span class="com">// or, to skip host verification: ssh.addHostKeyVerifier(new PromiscuousVerifier())</span><span class="pln">
ssh</span><span class="pun">.</span><span class="pln">connect</span><span class="pun">(</span><span class="str">"localhost"</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">try</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ssh</span><span class="pun">.</span><span class="pln">authPassword</span><span class="pun">(</span><span class="str">"user"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"password"</span><span class="pun">);</span><span class="pln"> </span><span class="com">// or ssh.authPublickey(System.getProperty("user.name"))</span><span class="pln">
    </span><span class="kwd">final</span><span class="pln"> </span><span class="typ">SFTPClient</span><span class="pln"> sftp </span><span class="pun">=</span><span class="pln"> ssh</span><span class="pun">.</span><span class="pln">newSFTPClient</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">try</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        sftp</span><span class="pun">.</span><span class="pln">get</span><span class="pun">(</span><span class="str">"test_file"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"/tmp/test.tmp"</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">finally</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        sftp</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">finally</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ssh</span><span class="pun">.</span><span class="pln">disconnect</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div></text><author><a href="/users/91495/sasha">Sasha</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p><a href="https://github.com/hierynomus/sshj" rel="nofollow noreferrer">hierynomus/sshj</a> has a complete implementation of SFTP version 3 (what OpenSSH implements)</p>
<p>Example code from <a href="https://github.com/hierynomus/sshj/blob/master/examples/src/main/java/net/schmizz/sshj/examples/SFTPUpload.java" rel="nofollow noreferrer">SFTPUpload.java</a></p>
<pre class="lang-java prettyprint prettyprinted" style=""><code><span class="kwd">package</span><span class="pln"> net</span><span class="pun">.</span><span class="pln">schmizz</span><span class="pun">.</span><span class="pln">sshj</span><span class="pun">.</span><span class="pln">examples</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">import</span><span class="pln"> net</span><span class="pun">.</span><span class="pln">schmizz</span><span class="pun">.</span><span class="pln">sshj</span><span class="pun">.</span><span class="typ">SSHClient</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> net</span><span class="pun">.</span><span class="pln">schmizz</span><span class="pun">.</span><span class="pln">sshj</span><span class="pun">.</span><span class="pln">sftp</span><span class="pun">.</span><span class="typ">SFTPClient</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> net</span><span class="pun">.</span><span class="pln">schmizz</span><span class="pun">.</span><span class="pln">sshj</span><span class="pun">.</span><span class="pln">xfer</span><span class="pun">.</span><span class="typ">FileSystemFile</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">File</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln">

</span><span class="com">/** This example demonstrates uploading of a file over SFTP to the SSH server. */</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">SFTPUpload</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">IOException</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">final</span><span class="pln"> </span><span class="typ">SSHClient</span><span class="pln"> ssh </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SSHClient</span><span class="pun">();</span><span class="pln">
        ssh</span><span class="pun">.</span><span class="pln">loadKnownHosts</span><span class="pun">();</span><span class="pln">
        ssh</span><span class="pun">.</span><span class="pln">connect</span><span class="pun">(</span><span class="str">"localhost"</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">try</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            ssh</span><span class="pun">.</span><span class="pln">authPublickey</span><span class="pun">(</span><span class="typ">System</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"user.name"</span><span class="pun">));</span><span class="pln">
            </span><span class="kwd">final</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> src </span><span class="pun">=</span><span class="pln"> </span><span class="typ">System</span><span class="pun">.</span><span class="pln">getProperty</span><span class="pun">(</span><span class="str">"user.home"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">File</span><span class="pun">.</span><span class="pln">separator </span><span class="pun">+</span><span class="pln"> </span><span class="str">"test_file"</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">final</span><span class="pln"> </span><span class="typ">SFTPClient</span><span class="pln"> sftp </span><span class="pun">=</span><span class="pln"> ssh</span><span class="pun">.</span><span class="pln">newSFTPClient</span><span class="pun">();</span><span class="pln">
            </span><span class="kwd">try</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                sftp</span><span class="pun">.</span><span class="pln">put</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileSystemFile</span><span class="pun">(</span><span class="pln">src</span><span class="pun">),</span><span class="pln"> </span><span class="str">"/tmp"</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">finally</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                sftp</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">finally</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            ssh</span><span class="pun">.</span><span class="pln">disconnect</span><span class="pun">();</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

</span><span class="pun">}</span></code></pre>
</div></text><author><a href="/users/126346/shikhar">shikhar</a></author><comments><comment><text><span class="comment-copy">nice job!! an example in the main page could be helpful though.</span></text><author><a class="comment-user" href="/users/421642/ohadr" title="3,472 reputation">OhadR</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>Andy, to delete file on remote system you need to use <code>(channelExec)</code> of JSch and pass unix/linux commands to delete it.</p>
</div></text><author><a href="/users/480686/pushpinder-rattan">Pushpinder Rattan</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>Try <a href="http://www.enterprisedt.com/products/edtftpjssl/overview.html" rel="nofollow noreferrer">edtFTPj/PRO</a>, a mature, robust SFTP client library that supports connection pools and asynchronous operations. Also supports FTP and FTPS so all bases for secure file transfer are covered.</p>
</div></text><author><a href="/users/109114/bruce-blackshaw">Bruce Blackshaw</a></author><comments><comment><text><span class="comment-copy">And please also mention that this library is paid and not free....</span></text><author><a class="comment-user" href="/users/1503768/oneconsciousness" title="197 reputation">oneConsciousness</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>I found complete working example for SFTP in java using JSCH API 
<a href="http://kodehelp.com/java-program-for-uploading-file-to-sftp-server/" rel="nofollow">http://kodehelp.com/java-program-for-uploading-file-to-sftp-server/</a></p>
</div></text><author><a href="/users/580515/dee-kay">Dee Kay</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>Though answers above were very helpful, I've spent a day to make them work, facing various exceptions like "broken channel", "rsa key unknown" and "packet corrupt".</p>
<p>Below is a working reusable class for SFTP FILES UPLOAD/DOWNLOAD using JSch library.</p>
<p>Upload usage:</p>
<pre class="lang-java prettyprint prettyprinted" style=""><code><span class="typ">SFTPFileCopy</span><span class="pln"> upload </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SFTPFileCopy</span><span class="pun">(</span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> </span><span class="pun">/</span><span class="pln">path</span><span class="pun">/</span><span class="pln">to</span><span class="pun">/</span><span class="pln">sourcefile</span><span class="pun">.</span><span class="pln">png</span><span class="str">", /path/to/destinationfile.png"</span><span class="pun">);</span></code></pre>
<p>Download usage:</p>
<pre class="lang-java prettyprint prettyprinted" style=""><code><span class="typ">SFTPFileCopy</span><span class="pln"> download </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SFTPFileCopy</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> </span><span class="str">"/path/to/sourcefile.png"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"/path/to/destinationfile.png"</span><span class="pun">);</span></code></pre>
<p>The class code:</p>
<pre class="lang-java prettyprint prettyprinted" style=""><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">jcraft</span><span class="pun">.</span><span class="pln">jsch</span><span class="pun">.</span><span class="typ">Channel</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">jcraft</span><span class="pun">.</span><span class="pln">jsch</span><span class="pun">.</span><span class="typ">ChannelSftp</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">jcraft</span><span class="pun">.</span><span class="pln">jsch</span><span class="pun">.</span><span class="typ">JSch</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">jcraft</span><span class="pun">.</span><span class="pln">jsch</span><span class="pun">.</span><span class="typ">Session</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">jcraft</span><span class="pun">.</span><span class="pln">jsch</span><span class="pun">.</span><span class="typ">UIKeyboardInteractive</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">jcraft</span><span class="pun">.</span><span class="pln">jsch</span><span class="pun">.</span><span class="typ">UserInfo</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">BufferedInputStream</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">BufferedOutputStream</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">ByteArrayInputStream</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">File</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">FileInputStream</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">FileNotFoundException</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">FileOutputStream</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">OutputStream</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> javax</span><span class="pun">.</span><span class="pln">swing</span><span class="pun">.</span><span class="typ">JOptionPane</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> menue</span><span class="pun">.</span><span class="typ">Menue</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">SFTPFileCopy1</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">SFTPFileCopy1</span><span class="pun">(</span><span class="kwd">boolean</span><span class="pln"> upload</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> sourcePath</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> destPath</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">FileNotFoundException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="typ">Session</span><span class="pln"> session </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">
        </span><span class="typ">Channel</span><span class="pln"> channel </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">
        </span><span class="typ">ChannelSftp</span><span class="pln"> sftpChannel </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">try</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="typ">JSch</span><span class="pln"> jsch </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">JSch</span><span class="pun">();</span><span class="pln">
            </span><span class="com">//jsch.setKnownHosts("/home/user/.putty/sshhostkeys");</span><span class="pln">
            session </span><span class="pun">=</span><span class="pln"> jsch</span><span class="pun">.</span><span class="pln">getSession</span><span class="pun">(</span><span class="str">"login"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"mysite.com"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">22</span><span class="pun">);</span><span class="pln">
            session</span><span class="pun">.</span><span class="pln">setPassword</span><span class="pun">(</span><span class="str">"password"</span><span class="pun">);</span><span class="pln">

            </span><span class="typ">UserInfo</span><span class="pln"> ui </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MyUserInfo</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> showMessage</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> message</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

                    </span><span class="typ">JOptionPane</span><span class="pun">.</span><span class="pln">showMessageDialog</span><span class="pun">(</span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> message</span><span class="pun">);</span><span class="pln">

                </span><span class="pun">}</span><span class="pln">

                </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> promptYesNo</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> message</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

                    </span><span class="typ">Object</span><span class="pun">[]</span><span class="pln"> options </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">"yes"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"no"</span><span class="pun">};</span><span class="pln">

                    </span><span class="kwd">int</span><span class="pln"> foo </span><span class="pun">=</span><span class="pln"> </span><span class="typ">JOptionPane</span><span class="pun">.</span><span class="pln">showOptionDialog</span><span class="pun">(</span><span class="kwd">null</span><span class="pun">,</span><span class="pln">
                            message</span><span class="pun">,</span><span class="pln">
                            </span><span class="str">"Warning"</span><span class="pun">,</span><span class="pln">
                            </span><span class="typ">JOptionPane</span><span class="pun">.</span><span class="pln">DEFAULT_OPTION</span><span class="pun">,</span><span class="pln">
                            </span><span class="typ">JOptionPane</span><span class="pun">.</span><span class="pln">WARNING_MESSAGE</span><span class="pun">,</span><span class="pln">
                            </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> options</span><span class="pun">,</span><span class="pln"> options</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]);</span><span class="pln">

                    </span><span class="kwd">return</span><span class="pln"> foo </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">

                </span><span class="pun">}</span><span class="pln">
            </span><span class="pun">};</span><span class="pln">
            session</span><span class="pun">.</span><span class="pln">setUserInfo</span><span class="pun">(</span><span class="pln">ui</span><span class="pun">);</span><span class="pln">

            session</span><span class="pun">.</span><span class="pln">setConfig</span><span class="pun">(</span><span class="str">"StrictHostKeyChecking"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"no"</span><span class="pun">);</span><span class="pln">
            session</span><span class="pun">.</span><span class="pln">connect</span><span class="pun">();</span><span class="pln">
            channel </span><span class="pun">=</span><span class="pln"> session</span><span class="pun">.</span><span class="pln">openChannel</span><span class="pun">(</span><span class="str">"sftp"</span><span class="pun">);</span><span class="pln">
            channel</span><span class="pun">.</span><span class="pln">setInputStream</span><span class="pun">(</span><span class="typ">System</span><span class="pun">.</span><span class="pln">in</span><span class="pun">);</span><span class="pln">
            channel</span><span class="pun">.</span><span class="pln">setOutputStream</span><span class="pun">(</span><span class="typ">System</span><span class="pun">.</span><span class="pln">out</span><span class="pun">);</span><span class="pln">
            channel</span><span class="pun">.</span><span class="pln">connect</span><span class="pun">();</span><span class="pln">
            sftpChannel </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ChannelSftp</span><span class="pun">)</span><span class="pln"> channel</span><span class="pun">;</span><span class="pln">

            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">upload</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="com">// File upload.</span><span class="pln">
                </span><span class="kwd">byte</span><span class="pun">[]</span><span class="pln"> bufr </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">File</span><span class="pun">(</span><span class="pln">sourcePath</span><span class="pun">).</span><span class="pln">length</span><span class="pun">()];</span><span class="pln">
                </span><span class="typ">FileInputStream</span><span class="pln"> fis </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileInputStream</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">File</span><span class="pun">(</span><span class="pln">sourcePath</span><span class="pun">));</span><span class="pln">
                fis</span><span class="pun">.</span><span class="pln">read</span><span class="pun">(</span><span class="pln">bufr</span><span class="pun">);</span><span class="pln">
                </span><span class="typ">ByteArrayInputStream</span><span class="pln"> fileStream </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ByteArrayInputStream</span><span class="pun">(</span><span class="pln">bufr</span><span class="pun">);</span><span class="pln">
                sftpChannel</span><span class="pun">.</span><span class="pln">put</span><span class="pun">(</span><span class="pln">fileStream</span><span class="pun">,</span><span class="pln"> destPath</span><span class="pun">);</span><span class="pln">
                fileStream</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span><span class="pln">
            </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="com">// File download.</span><span class="pln">
                </span><span class="kwd">byte</span><span class="pun">[]</span><span class="pln"> buffer </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[</span><span class="lit">1024</span><span class="pun">];</span><span class="pln">
                </span><span class="typ">BufferedInputStream</span><span class="pln"> bis </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">BufferedInputStream</span><span class="pun">(</span><span class="pln">sftpChannel</span><span class="pun">.</span><span class="pln">get</span><span class="pun">(</span><span class="pln">sourcePath</span><span class="pun">));</span><span class="pln">
                </span><span class="typ">OutputStream</span><span class="pln"> os </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileOutputStream</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">File</span><span class="pun">(</span><span class="pln">destPath</span><span class="pun">));</span><span class="pln">
                </span><span class="typ">BufferedOutputStream</span><span class="pln"> bos </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">BufferedOutputStream</span><span class="pun">(</span><span class="pln">os</span><span class="pun">);</span><span class="pln">
                </span><span class="kwd">int</span><span class="pln"> readCount</span><span class="pun">;</span><span class="pln">
                </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">((</span><span class="pln">readCount </span><span class="pun">=</span><span class="pln"> bis</span><span class="pun">.</span><span class="pln">read</span><span class="pun">(</span><span class="pln">buffer</span><span class="pun">))</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                    bos</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="pln">buffer</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> readCount</span><span class="pun">);</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
                bis</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span><span class="pln">
                bos</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">catch</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Exception</span><span class="pln"> e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="typ">System</span><span class="pun">.</span><span class="pln">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">e</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">finally</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sftpChannel </span><span class="pun">!=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                sftpChannel</span><span class="pun">.</span><span class="pln">exit</span><span class="pun">();</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">channel </span><span class="pun">!=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                channel</span><span class="pun">.</span><span class="pln">disconnect</span><span class="pun">();</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">session </span><span class="pun">!=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                session</span><span class="pun">.</span><span class="pln">disconnect</span><span class="pun">();</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">abstract</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MyUserInfo</span><span class="pln">
            </span><span class="kwd">implements</span><span class="pln"> </span><span class="typ">UserInfo</span><span class="pun">,</span><span class="pln"> </span><span class="typ">UIKeyboardInteractive</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

        </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> getPassword</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">

        </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> promptYesNo</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> str</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">

        </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> getPassphrase</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">

        </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> promptPassphrase</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> message</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">

        </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> promptPassword</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> message</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">

        </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> showMessage</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> message</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">

        </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> promptKeyboardInteractive</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> destination</span><span class="pun">,</span><span class="pln">
                </span><span class="typ">String</span><span class="pln"> name</span><span class="pun">,</span><span class="pln">
                </span><span class="typ">String</span><span class="pln"> instruction</span><span class="pun">,</span><span class="pln">
                </span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> prompt</span><span class="pun">,</span><span class="pln">
                </span><span class="kwd">boolean</span><span class="pun">[]</span><span class="pln"> echo</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div></text><author><a href="/users/1112963/zon">Zon</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>You also have JFileUpload with SFTP add-on (Java too):
<a href="http://www.jfileupload.com/products/sftp/index.html" rel="nofollow noreferrer">http://www.jfileupload.com/products/sftp/index.html</a></p>
</div></text><author><a>NONE</a></author><comments><comment><text><span class="comment-copy">JFileUpload is an applet, not a lib. License is commercial. Doesn't look active, either.</span></text><author><a class="comment-user" href="/users/3333174/r%c3%bc" title="591 reputation">rü-</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>I use this SFTP API called Zehon, it's great, so easy to use with a lot of sample code. Here is the site <a href="http://www.zehon.com" rel="nofollow noreferrer">http://www.zehon.com</a></p>
</div></text><author><a>NONE</a></author><comments><comment><text><span class="comment-copy">Zehon seems dead. And where's the source? What 'license' is behind 'free'?</span></text><author><a class="comment-user" href="/users/3333174/r%c3%bc" title="591 reputation">rü-</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>The best solution I've found is <a href="http://www.lag.net/paramiko/" rel="nofollow noreferrer">Paramiko</a>. There's a Java version.</p>
</div></text><author><a href="/users/53495/brian-clapper">Brian Clapper</a></author><comments><comment><text><span class="comment-copy"><a href="http://www.lag.net/jaramiko/" rel="nofollow noreferrer">lag.net/jaramiko</a>   last updated 12-Nov-2007  ;(</span></text><author><a class="comment-user" href="/users/63678/daniel-magnusson" title="5,732 reputation">Daniel  Magnusson</a></author></comment><comment><text><span class="comment-copy"><a href="https://github.com/terencehonles/jaramiko" rel="nofollow noreferrer">github.com/terencehonles/jaramiko</a> is abandoned in favor of JSch (see notice on github).</span></text><author><a class="comment-user" href="/users/3333174/r%c3%bc" title="591 reputation">rü-</a></author></comment></comments></answer></answers></post>