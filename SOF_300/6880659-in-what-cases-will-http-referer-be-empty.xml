<?xml version="1.0" encoding="utf-8"?>
<post><title>security - In what cases will HTTP_REFERER be empty - Stack Overflow</title><question><text><div class="post-text" itemprop="text">
<p>I know it's possible to get an empty HTTP_REFERER. Under what circumstances does this happen? If I get an empty one, does it always mean that the user changed it? Is getting an empty one the same as getting a null one? and under what circumstances do I get that too?</p>
</div></text><author><a href="/users/437/patrick-mcelhaney">Patrick McElhaney</a></author><comments><comment><text><span class="comment-copy">When the client doesn't send one.</span></text><author><a class="comment-user" href="/users/20862/ignacio-vazquez-abrams" title="478,668 reputation">Ignacio Vazquez-Abrams</a></author></comment></comments></question><answers><answer><text><div class="post-text" itemprop="text">
<p>It will/may be empty when the enduser</p>
<ul>
<li>entered the site URL in browser address bar itself.</li>
<li>visited the site by a browser-maintained bookmark.</li>
<li>visited the site as first page in the window/tab.</li>
<li>switched from a https URL to a http URL.</li>
<li>switched from a https URL to a different https URL.</li>
<li>has security software installed (antivirus/firewall/etc) which strips the referrer from all requests.</li>
<li>is behind a proxy which strips the referrer from all requests.</li>
<li>visited the site programmatically (like, <a href="http://php.net/manual/en/ref.curl.php">curl</a>) without setting the referrer header (searchbots!).</li>
</ul>
</div></text><author><a href="/users/157882/balusc">BalusC</a></author><comments><comment><text><span class="comment-copy">You might want to add "when the user transitions from a secure (HTTPS) page  to an insecure one".</span></text><author><a class="comment-user" href="/users/251034/john-pick" title="4,317 reputation">John Pick</a></author></comment><comment><text><span class="comment-copy">"visited the site as first page in the window/tab." Even if it was by clicking an on link and opening it in a new window/tab?? Are you sure? That would be a very wrong behavior of the browser</span></text><author><a class="comment-user" href="/users/723825/matteo" title="1,015 reputation">matteo</a></author></comment><comment><text><span class="comment-copy">Also see here <a href="http://stackoverflow.com/questions/21922143/why-isnt-the-referral-removed-for-google-https-http" title="why isnt the referral removed for google https http">stackoverflow.com/questions/21922143/…</a> for exeptions to this</span></text><author><a class="comment-user" href="/users/25700/getfree" title="16,561 reputation">GetFree</a></author></comment><comment><text><span class="comment-copy">@undone - I think that the referrer header is preserved when going from https to https unless the referrer metatag specifies otherwise. Can you cite a source that says otherwise?  (ref: <a href="http://smerity.com/articles/2013/where_did_all_the_http_referrers_go.html" rel="nofollow noreferrer">smerity.com/articles/2013/…</a>)</span></text><author><a class="comment-user" href="/users/915948/slang" title="504 reputation">slang</a></author></comment><comment><text><span class="comment-copy">@slang I couldn't find the source but I remember that I checked that with old browsers couple of year ago,but apparently that's not the case anymore.</span></text><author><a class="comment-user" href="/users/440546/undone" title="6,515 reputation">undone</a></author></comment><comment><text><span class="comment-copy">Any update/reply regarding @matteo comment?</span></text><author><a class="comment-user" href="/users/998096/ofir-baruch" title="7,577 reputation">Ofir Baruch</a></author></comment><comment><text><span class="comment-copy">"has security software installed (antivirus/firewall/etc) which strips the referrer from all requests." has saved my life. Thank you :)</span></text><author><a class="comment-user" href="/users/767625/anjana-silva" title="978 reputation">Anjana Silva</a></author></comment><comment><text><span class="comment-copy">@AnjanaSilva why does a security software do that?</span></text><author><a class="comment-user" href="/users/351903/sandeepan-nath" title="2,781 reputation">Sandeepan Nath</a></author></comment><comment><text><span class="comment-copy">"switched from a https URL to a different https URL". Are you sure about this? :\</span></text><author><a class="comment-user" href="/users/297114/oscar-mederos" title="14,812 reputation">Oscar Mederos</a></author></comment><comment><text><span class="comment-copy">links from inside of a Flash app usually do not send the referrer header either. Important if you are still using flash navigation, map, or ads.</span></text><author><a class="comment-user" href="/users/1042374/leiavoia" title="133 reputation">leiavoia</a></author></comment><comment><text><span class="comment-copy">i have no referrer going from an https URL to a different https URL</span></text><author><a class="comment-user" href="/users/339843/tofutim" title="8,562 reputation">tofutim</a></author></comment><comment><text><span class="comment-copy">Or if the link had attribute rel="noreferrer" It is used to prevent private / intranet information leakage.</span></text><author><a class="comment-user" href="/users/3114966/noman-riffat" title="72 reputation">Noman Riffat</a></author></comment><comment><text><span class="comment-copy">By default, switching from an HTTPS URL to a different HTTPS URL does set the full referer. This default policy can however be overridden. <a href="https://www.w3.org/TR/referrer-policy/" rel="nofollow noreferrer">w3.org/TR/referrer-policy</a></span></text><author><a class="comment-user" href="/users/3307716/dhaval-kapil" title="280 reputation">Dhaval Kapil</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>HTTP_REFERER - sent by the browser, stating the last page the browser viewed!</p>
<p>If you trusting [HTTP_REFERER] for any reason that is important, you should not, since it can be faked easily:</p>
<ol>
<li>Some browsers limit access to not allow HTTP_REFERER to be passed</li>
<li>Type a address in the address bar will not pass the HTTP_REFERER</li>
<li>open a new browser window will not pass the HTTP_REFERER, because HTTP_REFERER = NULL</li>
<li>has some browser addon that blocks it for privacy reasons. Some firewalls and AVs do to.</li>
</ol>
<p>Try this firefox extension, you'll be able to set any headers you want:</p>
<p>@Master of Celebration:</p>
<p><strong>Firefox:</strong> </p>
<p><em>extensions:</em> <a href="https://addons.mozilla.org/en-US/firefox/addon/refspoof/" rel="noreferrer">refspoof</a>, <a href="https://addons.mozilla.org/en-US/firefox/addon/refcontrol/" rel="noreferrer">refontrol</a>, <a href="https://addons.mozilla.org/en-US/firefox/addon/modify-headers/" rel="noreferrer">modify headers</a>, <a href="https://addons.mozilla.org/en-US/firefox/addon/no-referer/" rel="noreferrer">no-referer</a></p>
<p><em>Completely disable:</em> the option is available in about:config under "network.http.sendRefererHeader" and you want to set this to 0 to disable referer passing.</p>
<p><strong>Google chrome / Chromium:</strong></p>
<p><em>extensions:</em> <a href="https://chrome.google.com/webstore/detail/dkpkjedlegmelkogpgamcaemgbanohip" rel="noreferrer">noref</a>, <a href="https://chrome.google.com/webstore/detail/kkcdhmhggbdgjiehnfkdklfegjlhjfmh" rel="noreferrer">spoofy</a>, <a href="https://chrome.google.com/webstore/detail/lobgjaciknombeehlellklmbakbphhll" rel="noreferrer">external noreferrer</a></p>
<p><em>Completely disable:</em> Chnage ~/.config/google-chrome/Default/Preferences or ~/.config/chromium/Default/Preferences  and set this:</p>
<pre><code>{
   ...
   "enable_referrers": false,
   ...
}
</code></pre>
<p><em>Or simply add --no-referrers to shortcut or in cli:</em></p>
<pre><code>google-chrome --no-referrers
</code></pre>
<p><strong>Opera:</strong></p>
<p><em>Completely disable:</em> Settings &gt; Preferences &gt; Advanced &gt; Network, and uncheck "Send referrer information"</p>
<p><strong>Spoofing web service:</strong></p>
<p><a href="http://referer.us/" rel="noreferrer">http://referer.us/</a></p>
<p><strong>Standalone filtering proxy (spoof any header):</strong></p>
<p><a href="http://www.privoxy.org/" rel="noreferrer">Privoxy</a></p>
<p><strong>Spoofing http_referer  when using wget</strong></p>
<p>‘--referer=url’</p>
<p><strong>Spoofing http_referer when using curl</strong></p>
<p>-e, --referer </p>
<p><strong>Spoofing http_referer wth telnet</strong></p>
<pre><code>telnet www.yoursite.com 80 (press return)
GET /index.html HTTP/1.0 (press return)
Referer: http://www.hah-hah.com (press return)
(press return again)
</code></pre>
</div></text><author><a href="/users/849004/thatguy">ThatGuy</a></author><comments><comment><text><span class="comment-copy"><a href="https://addons.mozilla.org/en-US/firefox/addon/tamper-data/" rel="nofollow noreferrer">Tamper Data</a> is another Firefox extension that's worth a look if you want to play with changing referrer values.</span></text><author><a class="comment-user" href="/users/822053/chris-hepner" title="1,490 reputation">Chris Hepner</a></author></comment><comment><text><span class="comment-copy">I was trying really hard to remember it's name. but my memory betrayed me. Thanks:)</span></text><author><a class="comment-user" href="/users/849004/thatguy" title="11,630 reputation">ThatGuy</a></author></comment><comment><text><span class="comment-copy">@nix <code>Some browsers limit access to not allow HTTP_REFERER to be passed</code> Could you please name an example for such browser and/or extension?</span></text><author><a class="comment-user" href="/users/529190/master-of-celebration" title="78 reputation">Master of Celebration</a></author></comment><comment><text><span class="comment-copy">@MasterofCelebration added ways to spoof http_referer into my answer.</span></text><author><a class="comment-user" href="/users/849004/thatguy" title="11,630 reputation">ThatGuy</a></author></comment><comment><text><span class="comment-copy">Do not use referer.us to spoof / hide your referrer! It <a href="https://url.rw/?https%3A%2F%2Fhidemyreferrer.com%2Fwhat-is-my-referer%2F" rel="nofollow noreferrer">does not work</a> and leaks your information. The only working service right now is this free <a href="https://hidemyreferrer.com/" rel="nofollow noreferrer">hide referrer</a> service.</span></text><author><a class="comment-user" href="/users/1330199/brian-smith" title="409 reputation">Brian Smith</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>BalusC's list is solid. One additional way this field frequently appears empty is when the user is behind a proxy server. This is similar to being behind a firewall but is slightly different so I wanted to mention it for the sake of completeness.</p>
</div></text><author><a href="/users/615686/night-owl">Night Owl</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>It will also be empty if the new <a href="http://www.w3.org/TR/referrer-policy" rel="nofollow">Referrer Policy standard draft</a> is used to prevent that the referer header is sent to the request origin. Example:</p>
<pre><code>&lt;meta name="referrer" content="none"&gt;
</code></pre>
<p>Although Chrome and Firefox have already implemented a draft version of the Referrer Policy, you should be careful with it because for example Chrome expects <code>no-referrer</code> instead of <code>none</code> (and I have seen also <code>never</code> somewhere).</p>
</div></text><author><a href="/users/1367730/joel-richard">Joel Richard</a></author><comments/></answer></answers></post>