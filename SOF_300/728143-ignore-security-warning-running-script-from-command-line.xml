<?xml version="1.0" encoding="utf-8"?>
<post><title>powershell - Ignore 'Security Warning' running script from command line - Stack Overflow</title><question><text><div class="post-text" itemprop="text">
<p>I am trying to execute a script from shared folder that I trust:</p>
<pre class="lang-bsh prettyprint prettyprinted" style=""><code><span class="typ">PowerShell</span><span class="pln"> </span><span class="pun">-</span><span class="pln">file </span><span class="str">"\\server\scripts\my.ps1"</span></code></pre>
<p>But I get a security warning, and have to press 'R' to continue</p>
<blockquote>
<p>Security Warning Run only scripts that
  you trust. While scripts from the
  Internet can be useful, this script
  can potentially harm your computer. Do
  you want  to run
  \server\scripts\my.ps1? [D] Do not
  run  [R] Run once  [S] Suspend  [?]
  Help (default is "D"): d</p>
</blockquote>
<p>Can I ignore this warning? The desired pseudo code I want is:</p>
<pre class="lang-bsh prettyprint prettyprinted" style=""><code><span class="typ">PowerShell</span><span class="pln"> </span><span class="pun">-</span><span class="pln">IGNORE_SECURITY_WARNING </span><span class="pun">-</span><span class="pln">file </span><span class="str">"\\server\scripts\my.ps1"</span></code></pre>
</div></text><author><a href="/users/5339320/jacob-loves-rockstar">Jacob loves Rockstar</a></author><comments/></question><answers><answer><text><div class="post-text" itemprop="text">
<p>This is touched in <a href="http://www.leeholmes.com/blog/2008/07/24/powershell-execution-policies-in-standard-images/" rel="noreferrer">"PowerShell Execution Policies in Standard Images" on Lee Holmes' Blog</a> and <a href="http://blogs.msdn.com/powershell/archive/2008/09/30/powershell-s-security-guiding-principles.aspx" rel="noreferrer">"PowerShell’s Security Guiding Principles" on the <em>Windows Power Shell Blog</em>
</a>.</p>
<p><strong>Summary</strong>
Some machines treat UNC paths as the big bad internet, so PowerShell treats them as remote files. You can either disable this feature on those servers (<code>UncAsIntranet = 0,</code>) or add the remote machines to your trusted hosts.</p>
<p>If you want to do neither, PowerShell v2 supports an <code>-ExecutionPolicy</code> parameter that does exactly what your pseudocode wants. <code>PowerShell -ExecutionPolicy Bypass -File (...)</code>.</p>
</div></text><author><a href="/users/83482/leeholmes">LeeHolmes</a></author><comments><comment><text><span class="comment-copy">Thank you! -ExecutionPolicy Bypass is exactly what I was looking for.</span></text><author><a class="comment-user owner" href="/users/62192/alex2k8" title="20,720 reputation">alex2k8</a></author></comment><comment><text><span class="comment-copy">@LeeHomes I was looking for something else but <code>-ExecutionPolicy ByPass</code> fixed my problem. You saved me lot of googling and time. Thanks</span></text><author><a class="comment-user" href="/users/209834/suhas" title="2,352 reputation">Suhas</a></author></comment><comment><text><span class="comment-copy">Just to clarify - "add to trusted hosts" means in the system's internet options, available via control panel or in internet explorer.  The name appears to be a string match.  my share name is <code>\\foo-files</code>.  Adding the name <code>foo-files.example.com</code> to trusted hosts did not work, i had to just add the name <code>foo-files</code>.</span></text><author><a class="comment-user" href="/users/908796/dan-pritts" title="594 reputation">Dan Pritts</a></author></comment><comment><text><span class="comment-copy">Re: <code>-ExecutionPolicy</code> This command only whitelists the script for the instance in which it's being run, offering no help to those running scripts usign the "Run" button in PowerShell ISE.  Is there a way to globally trust this file that 1. Is persistent -- and -- 2. Doesn't involved executing the script.  Futher caution... Changing the Local Intranet zone and/or Trusted Zones on a domain can have unintended side-effects on websites which rely on specific browser features to work.  For example, ActiveX, http and ws traffic can be unobviously blocked depending on the origin vs. zone.</span></text><author><a class="comment-user" href="/users/3196753/qz-support" title="637 reputation">QZ Support</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>To avoid warnings, you can: </p>
<pre class="lang-bsh prettyprint prettyprinted" style=""><code><span class="typ">Set</span><span class="pun">-</span><span class="typ">ExecutionPolicy</span><span class="pln"> bypass</span></code></pre>
</div></text><author><a href="/users/1331258/alfredo-jim%c3%a9nez">Alfredo Jiménez</a></author><comments><comment><text><span class="comment-copy">Warning: This sets ExecutionPolicy on the entire machine, which is a big security risk.  @LeeHolmes solution up above sets ExecutionPolicy just for that session, which is a lower risk.</span></text><author><a class="comment-user" href="/users/1001100/jamesqmurphy" title="1,977 reputation">JamesQMurphy</a></author></comment><comment><text><span class="comment-copy">I find the security implications to be atrocious however this is the only way I've found to edit a remote file with PowerShell ISE and not have a popup each time the run button is clicked... at least without changing Internet Security settings which -- in the case of the target environment -- would break ActiveX content as well as some poorly-chosen-but-needed cross-domain security settings that only work in the default Local Intranet Zone.</span></text><author><a class="comment-user" href="/users/3196753/qz-support" title="637 reputation">QZ Support</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>If you're running into this error from a downloaded powershell script, you can unblock the script this way:</p>
<ol>
<li><p>Right-click on the <code>.ps1</code> file in question, and select <strong>Properties</strong></p></li>
<li><p>Click <strong>Unblock</strong> in the file properties</p>
<p><img alt="enter image description here" src="https://i.stack.imgur.com/jOpzn.png"/></p></li>
<li><p>Click <strong>OK</strong></p></li>
</ol>
</div></text><author><a href="/users/770938/mopsled">mopsled</a></author><comments><comment><text><span class="comment-copy">Thanks!! This worked for me, i was being prompted every launch even with Set-ExecutionPolicy Unrestricted</span></text><author><a class="comment-user" href="/users/1073280/choco-smith" title="1,028 reputation">Choco Smith</a></author></comment><comment><text><span class="comment-copy">You can also use the Unblock-File commandlet</span></text><author><a class="comment-user" href="/users/758067/jhclark" title="1,341 reputation">jhclark</a></author></comment><comment><text><span class="comment-copy">At least on my machine, <code>Unblock-File</code> does not seem to help with a UNC path as illustrated in the original question nor does the <code>Unblock</code> button appear in the file's property dialog.  I assume this is because your file is hosted locally <code>C:\...</code>, which makes this answer invalid to the original question (albeit helpful to &gt;=28 others)</span></text><author><a class="comment-user" href="/users/3196753/qz-support" title="637 reputation">QZ Support</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>Try this, edit the file with:</p>
<pre class="lang-bsh prettyprint prettyprinted" style=""><code><span class="pln">notepad foo</span><span class="pun">.</span><span class="pln">ps1</span><span class="pun">:</span><span class="typ">Zone</span><span class="pun">.</span><span class="typ">Identifier</span></code></pre>
<p>And set 'ZoneId=0'</p>
</div></text><author><a href="/users/85287/don-werve">Don Werve</a></author><comments><comment><text><span class="comment-copy">Or, in V3, <code>Unblock-File</code> (though this comment and this answer both have nothing to do with the IO's question)</span></text><author><a class="comment-user" href="/users/11635/ruben-bartelink" title="35,279 reputation">Ruben Bartelink</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>You want to set the execution policy on your machine using Set-ExecutionPolicy:</p>
<pre class="lang-bsh prettyprint prettyprinted" style=""><code><span class="typ">Set</span><span class="pun">-</span><span class="typ">ExecutionPolicy</span><span class="pln"> </span><span class="typ">Unrestricted</span></code></pre>
<p>You may want to investigate the various execution policies to see which one is right for you. Take a look at the "<code>help about_signing</code>" for more information.</p>
</div></text><author><a href="/users/4304/zdan">zdan</a></author><comments><comment><text><span class="comment-copy">That will change the execution policy permanently, which may nor be desired for a one-off use.</span></text><author><a class="comment-user" href="/users/73070/joey" title="220,967 reputation">Joey</a></author></comment><comment><text><span class="comment-copy">setting ExecutionPolicy to Unrestricted allows network script execution, but does not bypass the prompt.</span></text><author><a class="comment-user" href="/users/1189757/yevgeniy" title="369 reputation">Yevgeniy</a></author></comment><comment><text><span class="comment-copy">You want to use "bypass" instead of "unrestricted". "Bypass" is even LESS restrictive than "unrestricted" and gets rid of the security prompting.</span></text><author><a class="comment-user" href="/users/398327/warren-stevens" title="596 reputation">Warren Stevens</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>Just assign 1 to SEE_MASK_NOZONECHECKS env variable <br/></p>
<pre class="lang-bsh prettyprint prettyprinted" style=""><code><span class="pln">$env</span><span class="pun">:</span><span class="pln">SEE_MASK_NOZONECHECKS </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
</span><span class="typ">Start</span><span class="pun">-</span><span class="typ">Process</span><span class="pln"> $msi_file_path </span><span class="pun">/</span><span class="pln">qn </span><span class="pun">-</span><span class="typ">Wait</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> out</span><span class="pun">-</span><span class="pln">null</span></code></pre>
</div></text><author><a href="/users/4612917/jameel-grand">Jameel Grand</a></author><comments><comment><text><span class="comment-copy"><code>Start-Process</code> doesn't support <code>-ExecutionPolicy Bypass</code> so it was failing on an UNC path, even with UAC disabled. But with this trick it works. Upvoting with all my hands.</span></text><author><a class="comment-user" href="/users/1923328/laurent-caillette" title="333 reputation">Laurent Caillette</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>Did you download the script from internet?</p>
<p>Then remove NTFS stream from the file using sysinternal's <a href="http://technet.microsoft.com/en-us/sysinternals/bb897440.aspx" rel="nofollow noreferrer">streams.exe</a> on command line.</p>
<pre class="lang-bsh prettyprint prettyprinted" style=""><code><span class="pln">cmd</span><span class="pun">&gt;</span><span class="pln"> streams</span><span class="pun">.</span><span class="pln">exe </span><span class="pun">.</span><span class="pln">\my</span><span class="pun">.</span><span class="pln">ps1</span></code></pre>
<p>Now try to run the script again.</p>
</div></text><author><a href="/users/4035/sung">Sung</a></author><comments><comment><text><span class="comment-copy">Or, in V3, <code>Unblock-File</code> (though this comment and this answer both have nothing to do with the IO's question)</span></text><author><a class="comment-user" href="/users/11635/ruben-bartelink" title="35,279 reputation">Ruben Bartelink</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>None of this worked in my specific instance.  What did was changing to a NetBIOS name from the FQDN.  </p>
<p>Instead of:<br/>
<code>\\server.domain.net\file.ps1</code><br/>
use:<br/>
<code>\\server\file.ps1</code></p>
<p>Using the name bypasses the "automatically detect intranet network" config in IE.</p>
<p>See Option 1 in the blog here:
<a href="http://setspn.blogspot.com/2011/05/running-powershell-scripts-from-unc.html" rel="nofollow">http://setspn.blogspot.com/2011/05/running-powershell-scripts-from-unc.html</a></p>
</div></text><author><a href="/users/4032066/lightwing">lightwing</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>Assume that you need to launch ps script from shared folder</p>
<pre class="lang-bsh prettyprint prettyprinted" style=""><code><span class="pln">copy \\\server\script</span><span class="pun">.</span><span class="pln">ps1 c</span><span class="pun">:</span><span class="pln">\tmp</span><span class="pun">.</span><span class="pln">ps1 </span><span class="pun">/</span><span class="pln">y </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="typ">PowerShell</span><span class="pun">.</span><span class="pln">exe </span><span class="pun">-</span><span class="typ">ExecutionPolicy</span><span class="pln"> </span><span class="typ">Bypass</span><span class="pln"> </span><span class="pun">-</span><span class="typ">File</span><span class="pln"> c</span><span class="pun">:</span><span class="pln">\tmp</span><span class="pun">.</span><span class="pln">ps1 </span><span class="pun">&amp;&amp;</span><span class="pln"> del </span><span class="pun">/</span><span class="pln">f c</span><span class="pun">:</span><span class="pln">\tmp</span><span class="pun">.</span><span class="pln">ps1</span></code></pre>
<p>P.S.
Reduce googling)</p>
</div></text><author><a href="/users/2046674/alex">Alex</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>I made this powershell script to unblock all files on a share on my server</p>
<pre class="lang-bsh prettyprint prettyprinted" style=""><code><span class="typ">Get</span><span class="pun">-</span><span class="typ">ChildItem</span><span class="pln"> </span><span class="str">"\\ServerName\e$\MyDirectory\" -Recurse -File | % {
       Unblock-File -Path $_.FullName
}</span></code></pre>
</div></text><author><a href="/users/6938156/peter-veg">Peter Veg</a></author><comments><comment><text><span class="comment-copy"><code>Unblock-File</code> did not work in my tests (Windows 10, PowerShell ISE).</span></text><author><a class="comment-user" href="/users/3196753/qz-support" title="637 reputation">QZ Support</a></author></comment></comments></answer></answers></post>