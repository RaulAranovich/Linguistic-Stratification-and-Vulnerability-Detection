<?xml version="1.0" encoding="utf-8"?>
<post><title>security - How does this checkbox recaptcha work and how can I use it? - Stack Overflow</title><question><text><div class="post-text" itemprop="text">
<p>I've recently signed up to the oneplusone website <a href="https://account.oneplus.net/sign-up">https://account.oneplus.net/sign-up</a>, and noticed this checkbox recaptcha</p>
<p><a href="https://i.stack.imgur.com/jqNhK.gif"><img alt="checkbox recaptcha" src="https://i.stack.imgur.com/jqNhK.gif"/></a></p>
<p>How does it work, and how can I use it on my sites? Much better than those cryptic words/digits:)</p>
<p>The recaptcha site does not mention any new recaptcha method... <a href="https://www.google.com/recaptcha/intro/index.html">https://www.google.com/recaptcha/intro/index.html</a></p>
</div></text><author><a href="/users/1677912/mogsdad">Mogsdad</a></author><comments><comment><text><span class="comment-copy">I saw it at exactly the same place, and wondered the exact same thing. I'm putting up a bounty to attract attention. I'm curious as well.</span></text><author><a class="comment-user" href="/users/871050/madara-uchiha" title="93,456 reputation">Madara Uchiha<span class="mod-flair" title="moderator">♦</span></a></author></comment><comment><text><span class="comment-copy">Maybe it's in testing and not ready to be released yet?</span></text><author><a class="comment-user" href="/users/3791372/user3791372" title="1,618 reputation">user3791372</a></author></comment><comment><text><span class="comment-copy">An easy way to do this is <code>$('form input[type=submit]') .before('&lt;div&gt;Are you a human? &lt;input type="checkbox" name="captcha" /&gt;&lt;/div&gt;');</code> bots won't check the box because it's not part of the form. <a href="http://jsfiddle.net/s6jkchmz/" rel="nofollow noreferrer">jsfiddle.net/s6jkchmz</a></span></text><author><a class="comment-user" href="/users/2756409/tylerh" title="12,186 reputation">TylerH</a></author></comment><comment><text><span class="comment-copy">I don't see a setting for it in the reCAPTCHA admin panel, and when I mimic the layout <a href="https://account.oneplus.net/sign-up" rel="nofollow noreferrer">they</a> are using I get <a href="https://zornco.com/recaptcha.php" rel="nofollow noreferrer"><code>ERROR: Site key is not enabled for this API</code></a>. To me, that seems to tell us that it's a new reCAPTCHA API that not everyone has access to, yet.</span></text><author><a class="comment-user" href="/users/2537258/timothy-zorn" title="377 reputation">Timothy Zorn</a></author></comment><comment><text><span class="comment-copy">There's also the honeypot method of putting an irresistible input field in the form (like 'comments') and then hiding it with css/js.  If the data is present then the sender is a bot.  I've used this and it works surprisingly well.</span></text><author><a class="comment-user" href="/users/1257931/david-h-bennett" title="1,348 reputation">David H. Bennett</a></author></comment><comment><text><span class="comment-copy">FYI: <a href="http://googleonlinesecurity.blogspot.hu/2014/12/are-you-robot-introducing-no-captcha.html" rel="nofollow noreferrer">googleonlinesecurity.blogspot.hu/2014/12/…</a></span></text><author><a class="comment-user" href="/users/3469391/pred" title="5,493 reputation">Pred</a></author></comment><comment><text><span class="comment-copy">I'm sure they use a lot of information to determine as well. How long before the user mouses into the captcha box, their behavior in the box, where the eventually click inside the box, etc.</span></text><author><a class="comment-user" href="/users/379163/fellowmd" title="324 reputation">FellowMD</a></author></comment><comment><text><span class="comment-copy">Is there a way to restrict the checkbox by using checkbox ID or Class those were generated by dynamically, because I would wanna restrict the user if they didn't check the check box</span></text><author><a class="comment-user" href="/users/3514458/krish" title="187 reputation">Krish</a></author></comment></comments></question><answers><answer><text><div class="post-text" itemprop="text">
<p>This is a beta API for reCAPTCHA. I gather this from the source of their JS API: <a href="https://www.google.com/recaptcha/api.js">https://www.google.com/recaptcha/api.js</a> referencing "API2". And I also found this: <a href="http://jaswsinc.com/recaptcha-ads/">http://jaswsinc.com/recaptcha-ads/</a> Apparently they did an invite-only beta of their "no CAPTCHA reCAPTCHA" So.... You probably won't be able to make it work on your site, yet. I can't find any information on opting into the beta, but if you search for "No CAPTCHA reCAPTCHA beta" you can see a number of people that have mentioned getting the email from Google for them to join.</p>
<p>If you find a place to get into the beta, please share! Otherwise it looks like public release is coming in 2015...</p>
</div></text><author><a href="/users/4003739/ian-m">Ian M</a></author><comments><comment><text><span class="comment-copy">You <i>could</i> try to frankenstein something together using <a href="http://www.gstatic.com/recaptcha/api2/r20140903161709/recaptcha__en.js" rel="nofollow noreferrer">gstatic.com/recaptcha/api2/r20140903161709/recaptcha__en.js</a> if you search for "g-recaptcha", "I'm not a robot" or "checkbox" you can find the code that is implementing it there.</span></text><author><a class="comment-user" href="/users/4003739/ian-m" title="726 reputation">Ian M</a></author></comment><comment><text><span class="comment-copy">Excerpt from the email: <code>We expect to move all existing reCAPTCHA sites to the new API in 2015.</code></span></text><author><a class="comment-user" href="/users/2537258/timothy-zorn" title="377 reputation">Timothy Zorn</a></author></comment><comment><text><span class="comment-copy">Available now at <a href="https://www.google.com/recaptcha/" rel="nofollow noreferrer">google.com/recaptcha</a></span></text><author><a class="comment-user" href="/users/1430973/yoda" title="555 reputation">Yoda</a></author></comment><comment><text><span class="comment-copy">Here's Google's blog post announcing the new No CAPTCHA reCAPTCHA feature:  <a href="http://googleonlinesecurity.blogspot.com/2014/12/are-you-robot-introducing-no-captcha.html" rel="nofollow noreferrer">googleonlinesecurity.blogspot.com/2014/12/…</a></span></text><author><a class="comment-user" href="/users/902729/nealvs" title="101 reputation">Nealvs</a></author></comment><comment><text><span class="comment-copy">Where does this explain, how the new <code>No CAPTCHA reCAPTCHA</code> works?</span></text><author><a class="comment-user" href="/users/1750620/nikhil-girraj" title="654 reputation">Nikhil Girraj</a></author></comment><comment><text><span class="comment-copy">@Nikhil_Girraj if you notice, this answer was written before the "No CAPTCHA reCAPTCHA" was public (almost a year ago), so it addresses that it was in closed beta, and explains it should be available in 2015 (now). The original questions asks nothing of how it works, for that, here is the official reCAPTCHA page: <a href="https://www.google.com/recaptcha/intro/index.html" rel="nofollow noreferrer">google.com/recaptcha/intro/index.html</a> or see the post below.</span></text><author><a class="comment-user" href="/users/4003739/ian-m" title="726 reputation">Ian M</a></author></comment><comment><text><span class="comment-copy">@NikhilGirraj, if you'd like to know <b>how <i>No CAPTCHA reCAPTCHA</i> works</b>, I point you to <a href="http://scraping.pro/no-captcha-recaptcha-challenge/" rel="nofollow noreferrer">this post</a>.</span></text><author><a class="comment-user" href="/users/1230477/igor-savinkin" title="2,101 reputation">Igor Savinkin</a></author></comment><comment><text><span class="comment-copy">This answer is very outdated by now.</span></text><author><a class="comment-user" href="/users/1310566/simon-forsberg" title="9,624 reputation">Simon Forsberg</a></author></comment><comment><text><span class="comment-copy">@simon this answer was written when the latest recaptcha was still in closed beta.</span></text><author><a class="comment-user" href="/users/4003739/ian-m" title="726 reputation">Ian M</a></author></comment><comment><text><span class="comment-copy">@IanM I know, that's why I downvoted and added my comment. Today this answer does not provide much value.</span></text><author><a class="comment-user" href="/users/1310566/simon-forsberg" title="9,624 reputation">Simon Forsberg</a></author></comment><comment><text><span class="comment-copy">And the question is no longer relevant. This answer was correctly given for the question.</span></text><author><a class="comment-user" href="/users/4003739/ian-m" title="726 reputation">Ian M</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p><strong>This entry does not answer the original question, however it helps to implement a similar solution.</strong> <strike>As @IanM said, the checkbox recaptcha is in beta phase and it can't be used without invitation.</strike></p>
<p><strong>IMPORTANT EDIT</strong> Google introduced the new reCAPTCHA</p>
<ul>
<li><a href="http://googleonlinesecurity.blogspot.hu/2014/12/are-you-robot-introducing-no-captcha.html">Google Online Security blog: Are you a robot? Introducing “No CAPTCHA reCAPTCHA”</a></li>
<li><a href="https://www.google.com/recaptcha/intro/index.html">Google reCAPTCHA: Introducing the new reCAPTCHA!</a></li>
</ul>
<p>This is a JavaScript based CAPTCHA.</p>
<p>Since most spambots do not execute JavaScript and can not identify the correlation between the displayed text and the DOM or required actions they can not click on the checkbox.</p>
<p>Please note that there is no checkbox at all, it is just a div element with some CSS styling. Spambots are trying to fill the form input elements, but there is no input in the CAPTCHA. The check mark is just another div (css class).</p>
<p>When you click on the box an ajax request notifies the server that the div was clicked and the server stores this information in a temporary storage (marks the token: this token was activated by a human). When you submit the form, a hidden field sends the token which was activated, then when the server validates the form information it will recognize that the token was activated. If the token is not activated, the form will be invalidated.</p>
<p>The steps in bullet points:</p>
<ul>
<li>Generate a unique identifier and add it to the form with a hidden input</li>
<li>Render a checkbox on the site (without using the <code>&lt;input&gt;</code> element, possibly using <code>&lt;div&gt;</code>) and add the previously generated identifier to it (you can use the html5 <code>data-*</code> attributes)</li>
<li>When the user clicks on the checkbox, send an ajax request to the server and validate the CAPTCHA, if it is valid mark it as <code>in use</code>. (Show the result - identifier is OK/not OK - to the user)</li>
<li>When the user sends the form, the form's data contains the identifier. Check it once more, it should exist and it should be in <code>in use</code> state.</li>
<li>If all validations are passed, the form's data is ready to use/process</li>
</ul>
<p>You can bind the identifier to the user's session, IP address, and/or you can use time limits to improve security.</p>
<p><strong>NOTE</strong> This kind of CAPTCHA only works when the JavaScript is enabled!</p>
<p><strong>NOTE</strong> (edit 1) As @crazypotato stated, there are some automation tools, which can execute JavaScript, these tools also capable to send the proper AJAX request and fire the Click event on the checkbox div.</p>
<p><strong>NOTE</strong> (edit 2) Please note that a script written to specifically one site or to break one type of captcha will got through sooner or later. There is no ultimate protection, you can only make the bots (or their developers) work harder.</p>
<p><strong>NOTE</strong> (edit 3) The steps and the description in this answer only contains some basic information about this type of captcha, you always have to add additional validations and security steps to make it more secure. For example, Google noCaptcha systematically fires a standard reCaptcha after 3 "div clicks".</p>
</div></text><author><a href="/users/3469391/pred">Pred</a></author><comments><comment><text><span class="comment-copy">I think the question is specifically about "How do I enable this feature with Google's reCAPTCHA?" I'm pretty confident I can implement this myself, but it's not that simple with their case.</span></text><author><a class="comment-user" href="/users/871050/madara-uchiha" title="93,456 reputation">Madara Uchiha<span class="mod-flair" title="moderator">♦</span></a></author></comment><comment><text><span class="comment-copy">If you click Report a Problem on the bottom of a Streetview page you get the same new Recaptcha. That is where I first saw it and found this SO page when I went searching.</span></text><author><a class="comment-user" href="/users/2605793/user2605793" title="144 reputation">user2605793</a></author></comment><comment><text><span class="comment-copy">What would prevent a bot from sending that ajax request? If everyone (or a semi-large site) were to implement a CAPTCHA like this it would surely be exploited anyway. Cloudflare has a similar bot-detection system that seems to work without requiring the user to do anything.</span></text><author><a class="comment-user" href="/users/1106272/time-sheep" title="355 reputation">Time Sheep</a></author></comment><comment><text><span class="comment-copy">First of all, I totally agree with your comment and yes, a bot written directly to exploit one site will got throught (and this is true for any kind of capthas). I started my post with <code>most bots</code> and not <code>all bots</code>. There are also solutions when the image based captcha breaker simply sends the image to a software and a human types in the characters (and the employe is payed by the count of successful posts). How would you prevent this? :)</span></text><author><a class="comment-user" href="/users/3469391/pred" title="5,493 reputation">Pred</a></author></comment><comment><text><span class="comment-copy">@Pred "Spambots are trying to fill the form input elements, but there is no input in the CAPTCHA." That's pathetic. jackiechanface.jpg</span></text><author><a class="comment-user" href="/users/3996968/crazypotato" title="101 reputation">crazypotato</a></author></comment><comment><text><span class="comment-copy">@crazypotato Can you say that a css formatted div as an (x)HTML(5) input element?</span></text><author><a class="comment-user" href="/users/3469391/pred" title="5,493 reputation">Pred</a></author></comment><comment><text><span class="comment-copy">It can be anything. If its display in browser, you can automate click on this. In your previously comment you say something similar. But in answer wat??? Also most "spambots" can "solve" ReCaptcha, cause they use external service like antigate(and you say about this too in comment). Also (not) funny thing i can't and don't want solve ReCaptcha, so sites with this dead for me.</span></text><author><a class="comment-user" href="/users/3996968/crazypotato" title="101 reputation">crazypotato</a></author></comment><comment><text><span class="comment-copy">Also about javascript. <a href="http://www.seleniumhq.org/" rel="nofollow noreferrer">Selenium</a> <a href="https://addons.mozilla.org/en/firefox/addon/mozrepl/" rel="nofollow noreferrer">Mozrepl</a></span></text><author><a class="comment-user" href="/users/3996968/crazypotato" title="101 reputation">crazypotato</a></author></comment><comment><text><span class="comment-copy">You are right, and as I stated in a previos comment, a script/bot written to specificaly one site will probably broke any kind of protection sooner or later. Why do not you write an answer or edit mine with your additional info?</span></text><author><a class="comment-user" href="/users/3469391/pred" title="5,493 reputation">Pred</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>Here is my code running without problem in PHP:</p>
<p><strong>Client Side:</strong></p>
<pre><code>&lt;div class="g-recaptcha" data-sitekey="PUBLIC_KEY"&gt;&lt;/div&gt;
</code></pre>
<p><strong>Server Side:</strong></p>
<pre><code>if (isset($_POST['g-recaptcha-response'])) {
    $captcha = $_POST['g-recaptcha-response'];
    $privatekey = "SECRET_KEY";
    $url = 'https://www.google.com/recaptcha/api/siteverify';
    $data = array(
        'secret' =&gt; $privatekey,
        'response' =&gt; $captcha,
        'remoteip' =&gt; $_SERVER['REMOTE_ADDR']
    );

    $curlConfig = array(
        CURLOPT_URL =&gt; $url,
        CURLOPT_POST =&gt; true,
        CURLOPT_RETURNTRANSFER =&gt; true,
        CURLOPT_POSTFIELDS =&gt; $data
    );

    $ch = curl_init();
    curl_setopt_array($ch, $curlConfig);
    $response = curl_exec($ch);
    curl_close($ch);
}

$jsonResponse = json_decode($response);

if ($jsonResponse-&gt;success == "true")
    doSomething();
else
    doSomeOtherThing();
</code></pre>
<p>:)</p>
</div></text><author><a href="/users/1919749/ismaestro">Ismaestro</a></author><comments><comment><text><span class="comment-copy">haven't you left out some parts of the client side / html code? just asking because in your PHP code you're checking against a post named <code>g-recaptcha-response</code> but no such element is defined in your client side code... am I missing something?</span></text><author><a class="comment-user" href="/users/2037924/webeno" title="4,078 reputation">webeno</a></author></comment><comment><text><span class="comment-copy">@webeno Read this! <a href="https://developers.google.com/recaptcha/docs/verify" rel="nofollow noreferrer">developers.google.com/recaptcha/docs/verify</a></span></text><author><a class="comment-user" href="/users/1919749/ismaestro" title="550 reputation">Ismaestro</a></author></comment><comment><text><span class="comment-copy">makes sense, thanks for clarifying</span></text><author><a class="comment-user" href="/users/2037924/webeno" title="4,078 reputation">webeno</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>I came here in my search, did not see an answer, and so I kept searching.</p>
<p>After my search, this window was still open, so I am updating this post with my findings.</p>
<p>Here is where you can learn about <strong>reCAPTCHA</strong>:</p>
<p><a href="http://scraping.pro/no-captcha-recaptcha-challenge/" rel="nofollow">http://scraping.pro/no-captcha-recaptcha-challenge/</a></p>
<p>Basically, though, you add this to your web page:</p>
<pre><code>&lt;script src="https://www.google.com/recaptcha/api.js" &gt;;
&lt;form method="post"&gt;
    &lt;div class="g-recaptcha" data-sitekey="[site key issued by google]"&gt;&lt;/div&gt;
    &lt;input value="submit" type="submit" /&gt;
&lt;/form&gt;
</code></pre>
<p>To get your <strong>reCAPTCHA</strong> keys, go to this Google site:</p>
<p><a href="https://www.google.com/recaptcha/intro/index.html" rel="nofollow">https://www.google.com/recaptcha/intro/index.html</a></p>
<p>Once you have your keys using the link above, you can get deeper into the coding of this using the following Google information:</p>
<p><a href="https://developers.google.com/recaptcha/" rel="nofollow">https://developers.google.com/recaptcha/</a></p>
<h2>NOTE:</h2>
<p>From the Google documentation:</p>
<blockquote>
<p>The script must be loaded using the HTTPS protocol and can be included from any point on the page without restriction.</p>
</blockquote>
<h2>Here is an example of how I got it to work:</h2>
<pre><code>&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Contact&lt;/title&gt;
    &lt;script src="https://www.google.com/recaptcha/api.js" async defer&gt;&lt;/script&gt;
    &lt;script&gt;
    var onloadCallback = function () {
        grecaptcha.render('dvCaptcha', {
            'sitekey': '&lt;%=ReCaptcha_Key %&gt;',
            'callback': function (response) {
                $.ajax({
                    type: "POST",
                    url: "CS.aspx/VerifyCaptcha",
                    data: "{response: '" + response + "'}",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (r) {
                        var captchaResponse = jQuery.parseJSON(r.d);
                        if (captchaResponse.success) {
                            $("[id*=txtCaptcha]").val(captchaResponse.success);
                            $("[id*=lblAlarm]").hide();
                        } else {
                            $("[id*=txtCaptcha]").val("");
                            $("[id*=lblAlarm]").show();
                            var error = captchaResponse["error-codes"][0];
                            $("[id*=lblAlarm]").html("RECaptcha error. " + error);
                        }
                    }
                });
            }
        });
    };
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form action="?" method="POST"&gt;
        &lt;div id="dvCaptcha" class="g-recaptcha" data-sitekey="[site key issued by google]"&gt;&lt;/div&gt;
        &lt;br /&gt;
        &lt;asp:Button ID="btnSubmit" runat="Server" Text="Send" OnClick="btnSubmit_Click" /&gt;
        &lt;asp:Label ID="lblAlarm" runat="server" ForeColor="Red"&gt;&lt;/asp:Label&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>If you need to validate in the ASP.NET code-behind, simply verify the "g-recaptcha-response" control is filled in:</p>
<pre><code>protected static string ReCaptcha_Key, ReCaptcha_Secret;

protected void btnSubmit_Click(object sender, EventArgs e)
{
    if (!String.IsNullOrEmpty(Request.Form["g-recaptcha-response"]))
    {
        // other code
    } else
    {
       lblAlarm.Text = "reCAPTCHA failed.";
    }
}
</code></pre>
<p>Hopefully, some of you find this useful.</p>
</div></text><author><a href="/users/153923/jp2code">jp2code</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>Thank you all for your contribution to this thread, it's great to see so many people interested in the new recaptcha tool.</p>
<p>I couldn't find a .net implementation of it, so have built a simple web forms control, that you can find here <a href="https://github.com/pnmcosta/recaptchav2dotnet" rel="nofollow">https://github.com/pnmcosta/recaptchav2dotnet</a></p>
</div></text><author><a href="/users/271433/pedro-costa">Pedro Costa</a></author><comments/></answer></answers></post>