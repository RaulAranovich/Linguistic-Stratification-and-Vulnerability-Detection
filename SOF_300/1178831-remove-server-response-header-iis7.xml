<?xml version="1.0" encoding="utf-8"?>
<post><title>security - Remove Server Response Header IIS7 - Stack Overflow</title><question><text><div class="post-text" itemprop="text">
<p>Is there any way to remove "Server" response header from IIS7? There are some articles showing that using HttpModules we can achieve the same thing. This will be helpful if we don't have admin right to server. Also I don't want to write ISAPI filter.</p>
<p>I have admin rights to my server. So I don't want to do the above stuff. So, please help me to do the same.</p>
</div></text><author><a href="/users/247702/stijn">Stijn</a></author><comments><comment><text><span class="comment-copy">See: <a href="http://stackoverflow.com/questions/22401219/remove-server-response-header-iis-8-0-8-5#39472251" title="remove server response header iis 8 0 8 5%2339472251">stackoverflow.com/questions/22401219/…</a></span></text><author><a class="comment-user" href="/users/1356728/mohsen-unlimited" title="350 reputation">Mohsen Unlimited</a></author></comment></comments></question><answers><answer><text><div class="post-text" itemprop="text">
<p>Add this to your global.asax.cs:</p>
<pre class="lang-cs prettyprint prettyprinted" style=""><code><span class="kwd">protected</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Application_PreSendRequestHeaders</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="typ">Response</span><span class="pun">.</span><span class="typ">Headers</span><span class="pun">.</span><span class="typ">Remove</span><span class="pun">(</span><span class="str">"Server"</span><span class="pun">);</span><span class="pln">
    </span><span class="typ">Response</span><span class="pun">.</span><span class="typ">Headers</span><span class="pun">.</span><span class="typ">Remove</span><span class="pun">(</span><span class="str">"X-AspNet-Version"</span><span class="pun">);</span><span class="pln">
    </span><span class="typ">Response</span><span class="pun">.</span><span class="typ">Headers</span><span class="pun">.</span><span class="typ">Remove</span><span class="pun">(</span><span class="str">"X-AspNetMvc-Version"</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div></text><author><a href="/users/265570/bkaid">bkaid</a></author><comments><comment><text><span class="comment-copy">I tried the registry option from @Richard above with no luck. I'm using Win 2008 R2 and the registry key was missing so I added a new DWORD key, which may have been incorrect.  This option worked perfectly though. Thanks!</span></text><author><a class="comment-user" href="/users/603670/ben-barreth" title="806 reputation">Ben Barreth</a></author></comment><comment><text><span class="comment-copy">Don't know why the http module answer is higher than this one, this one is much easier</span></text><author><a class="comment-user" href="/users/56079/jjxtra" title="10,714 reputation">jjxtra</a></author></comment><comment><text><span class="comment-copy">This is the simplest method I've found to remove the 'Server' header from IIS7 responses. Thanks.</span></text><author><a class="comment-user" href="/users/471924/corgalore" title="988 reputation">Corgalore</a></author></comment><comment><text><span class="comment-copy">This should be the preferred answer. very small change</span></text><author><a class="comment-user" href="/users/516492/jnoreiga" title="1,522 reputation">jnoreiga</a></author></comment><comment><text><span class="comment-copy">For me it is displaying an error "Object reference not set to an instance of an object" I am stuck here</span></text><author><a class="comment-user" href="/users/530159/mathew-paul" title="306 reputation">Mathew Paul</a></author></comment><comment><text><span class="comment-copy">You might find you get a <code>NullReferenceException</code> in Cassini if you rely on <code>HttpContext.Current</code>. <a href="http://www.bugwriter.me/2010/01/removing-unnecessary-http-header-server.html" rel="nofollow noreferrer">This blog post</a> shows how to do so whilst avoiding breaking Cassini support, if that is important to you.</span></text><author><a class="comment-user" href="/users/205245/owen-blacker" title="2,662 reputation">Owen Blacker</a></author></comment><comment><text><span class="comment-copy">Weirdly, given this worked for me in September, this is no longer working for me. I can only assume one of the recent Windows Updates  messed with it (presumably the one that also added <a href="http://stackoverflow.com/q/9440744/205245"><code>net.tcp</code> and other bindings</a> the other day.</span></text><author><a class="comment-user" href="/users/205245/owen-blacker" title="2,662 reputation">Owen Blacker</a></author></comment><comment><text><span class="comment-copy">@PsychoDad this works for ASP.NET requests only, not for static files like .css and .js</span></text><author><a class="comment-user" href="/users/39923/max-toro" title="19,700 reputation">Max Toro</a></author></comment><comment><text><span class="comment-copy">Using IIS 8.0, I'm only seeing the Server header on ASP.NET requests, but not on static files.  When I add Response.Headers.Remove("Server"); I don't get the Server header at all.</span></text><author><a class="comment-user" href="/users/2034089/imjosh" title="2,309 reputation">imjosh</a></author></comment><comment><text><span class="comment-copy">To get rid of the MVC header you can do this MvcHandler.DisableMvcResponseHeader = true;</span></text><author><a class="comment-user" href="/users/1388341/provega" title="4,132 reputation">ProVega</a></author></comment><comment><text><span class="comment-copy">It is not a good idea to use the <code>PreSendRequestHeaders</code> in a class that implements <code>IHttpModule</code> or <code>Global.asax</code>. I have witnessed the event freezing the app on the server under stress load. The <code>BeginRequest</code> event should work to make response header changes. See <a href="http://www.hanselman.com/blog/ChecklistWhatNOTToDoInASPNET.aspx" rel="nofollow noreferrer">hanselman.com/blog/ChecklistWhatNOTToDoInASPNET.aspx</a> .</span></text><author><a class="comment-user" href="/users/395359/dmitry-s" title="5,812 reputation">Dmitry S.</a></author></comment><comment><text><span class="comment-copy">Can put this in EndRequest instead if you prefer, may avoid above freeze risk under load: protected void Application_EndRequest(object sender, EventArgs ev) { Response.Headers.Remove("Server"); }</span></text><author><a class="comment-user" href="/users/176877/chris-moschini" title="19,816 reputation">Chris Moschini</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>In IIS7 you have to use an HTTP module. Build the following as a class library in VS:</p>
<pre class="lang-cs prettyprint prettyprinted" style=""><code><span class="pln">namespace </span><span class="typ">StrongNamespace</span><span class="pun">.</span><span class="typ">HttpModules</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">CustomHeaderModule</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="typ">IHttpModule</span><span class="pln">
  </span><span class="pun">{</span><span class="pln"> 
    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Init</span><span class="pun">(</span><span class="typ">HttpApplication</span><span class="pln"> context</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
      context</span><span class="pun">.</span><span class="typ">PreSendRequestHeaders</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="typ">OnPreSendRequestHeaders</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> 

    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Dispose</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> 

    </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">OnPreSendRequestHeaders</span><span class="pun">(</span><span class="kwd">object</span><span class="pln"> sender</span><span class="pun">,</span><span class="pln"> </span><span class="typ">EventArgs</span><span class="pln"> e</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
      </span><span class="typ">HttpContext</span><span class="pun">.</span><span class="typ">Current</span><span class="pun">.</span><span class="typ">Response</span><span class="pun">.</span><span class="typ">Headers</span><span class="pun">.</span><span class="typ">Set</span><span class="pun">(</span><span class="str">"Server"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Box of Bolts"</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>Then add the following to your web.config, or you configure it within IIS (if you configure within IIS, the assembly must be in the GAC).</p>
<pre class="lang-xml prettyprint prettyprinted" style=""><code><span class="tag">&lt;configuration&gt;</span><span class="pln">
  </span><span class="tag">&lt;system.webServer&gt;</span><span class="pln">
    </span><span class="tag">&lt;modules&gt;</span><span class="pln">
      </span><span class="tag">&lt;add</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"CustomHeaderModule"</span><span class="pln">
       </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"StrongNamespace.HttpModules.CustomHeaderModule"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
    </span><span class="tag">&lt;/modules&gt;</span><span class="pln">
  </span><span class="tag">&lt;/system.webServer&gt;</span><span class="pln">
</span><span class="tag">&lt;/configuration&gt;</span></code></pre>
</div></text><author><a href="/users/147235/lukiffer">lukiffer</a></author><comments><comment><text><span class="comment-copy">Excellent, I can also tweak this to remove the ETag header across my server farm.</span></text><author><a class="comment-user" href="/users/41321/devstuff" title="7,160 reputation">devstuff</a></author></comment><comment><text><span class="comment-copy">This causes a runtime error in casini... / ASP.NET Dev server</span></text><author><a class="comment-user" href="/users/324381/upthecreek" title="12,976 reputation">UpTheCreek</a></author></comment><comment><text><span class="comment-copy">Modifying header values requires IIS7 Integrated Mode, however the exception is ignored unless another exception is thrown in the context of the request. Per the title, the question was targeted at IIS7, not casini.</span></text><author><a class="comment-user" href="/users/147235/lukiffer" title="7,395 reputation">lukiffer</a></author></comment><comment><text><span class="comment-copy">@UpTheCreek The ASP.Net dev server (Cassini) won't like that code; <a href="http://www.bugwriter.me/2010/01/removing-unnecessary-http-header-server.html" rel="nofollow noreferrer">this blog post</a> has a solution to it, though — you need to check that the <code>HttpApplication</code>, the <code>HttpRequest</code>, the <code>HttpContext</code>, and the <code>HttpResponse</code> are not <code>null</code>, as well as checking that <code>HttpRequest.IsLocal</code> is <code>false</code>.</span></text><author><a class="comment-user" href="/users/205245/owen-blacker" title="2,662 reputation">Owen Blacker</a></author></comment><comment><text><span class="comment-copy">Weirdly, given this worked for me in September, this is no longer working for me. I can only assume one of the recent Windows Updates  messed with it (presumably the one that also added <a href="http://stackoverflow.com/q/9440744/205245"><code>net.tcp</code> and other bindings</a> the other day.</span></text><author><a class="comment-user" href="/users/205245/owen-blacker" title="2,662 reputation">Owen Blacker</a></author></comment><comment><text><span class="comment-copy">As modifying the header in <code>PreSendRequestHeaders</code> could <a href="http://blogs.msdn.com/b/asiatech/archive/2010/10/18/heap-corruption-in-httpcachemodule-while-you-try-to-remove-http-headers-in-your-custom-http-module.aspx" rel="nofollow noreferrer">cause issues with HttpCacheModule</a>, you should use something like <code>PostReleaseRequestState</code> instead.</span></text><author><a class="comment-user" href="/users/543549/eirik-h" title="392 reputation">Eirik H</a></author></comment><comment><text><span class="comment-copy">The module is not invoked when IIS sends 304 Not Modified header for static files (css / less / images / etc) as this does not reach the ASP.NET pipeline, so in this situation Server: Microsoft IIS/7.5 is still rendered</span></text><author><a class="comment-user" href="/users/709653/jano" title="79 reputation">Jano</a></author></comment><comment><text><span class="comment-copy">This page is a top result for Google search "server "box of bolts"", so don't forget to change it to something unique or simply remove it by <code>HttpContext.Current.Response.Headers.Remove("Server");</code></span></text><author><a class="comment-user" href="/users/1689049/alexander-puchkov" title="4,332 reputation">Alexander Puchkov</a></author></comment><comment><text><span class="comment-copy">Note: if you use it with GAC you should write it with the full qualified name like "StrongNamespace.HttpModules.CustomHeaderModule, StrongNamespace, Version=4.2.0.0, Culture=neutral, PublicKeyToken=31FF3856AF364G35"</span></text><author><a class="comment-user" href="/users/471499/tarek-el-mallah" title="2,398 reputation">Tarek El-Mallah</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>use the IIS UrlRewrite 2.0</p>
<pre class="lang-xml prettyprint prettyprinted" style=""><code><span class="tag">&lt;outboundRules&gt;</span><span class="pln">
  </span><span class="tag">&lt;rule</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"Remove RESPONSE_Server"</span><span class="pln"> </span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;match</span><span class="pln"> </span><span class="atn">serverVariable</span><span class="pun">=</span><span class="atv">"RESPONSE_Server"</span><span class="pln"> </span><span class="atn">pattern</span><span class="pun">=</span><span class="atv">".+"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
    </span><span class="tag">&lt;action</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"Rewrite"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">""</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/rule&gt;</span><span class="pln">
</span><span class="tag">&lt;/outboundRules&gt;</span></code></pre>
</div></text><author><a href="/users/111774/jeffzhnn">JeffZhnn</a></author><comments><comment><text><span class="comment-copy">Note that this only blanks the Server header, it does not remove it.</span></text><author><a class="comment-user" href="/users/590558/nick-evans" title="2,054 reputation">Nick Evans</a></author></comment><comment><text><span class="comment-copy">Sorry for the ignorance but to which part should I add this in ?! I tried adding it inside &lt;system.webServer&gt;</span></text><author><a class="comment-user" href="/users/848841/vignesh" title="2,887 reputation">vignesh</a></author></comment><comment><text><span class="comment-copy">Thanks! Works in IIS 8.5, this is so easy. I don't have a text editor but you can easily use the GUI. The name should be RESPONSE_Server, not just Server (this is where I failed at first).</span></text><author><a class="comment-user" href="/users/1385709/louis-matthijssen" title="101 reputation">Louis Matthijssen</a></author></comment><comment><text><span class="comment-copy">this is good enough if you got a non-ASP.Net application therefor you can't remove server header with mentioned codes</span></text><author><a class="comment-user" href="/users/885899/mhesabi" title="359 reputation">mhesabi</a></author></comment><comment><text><span class="comment-copy">@vignesh this is some UrlRewrite config subnodes. You have to put them under a <code>rewrite</code> node in <code>system.webServer</code>. Beware, this will crash your site if UrlRewrite is not installed on the server. And you'd better use the IIS configuration console first to check how it write down those config nodes.</span></text><author><a class="comment-user" href="/users/1178314/fr%c3%a9d%c3%a9ric" title="4,289 reputation">Frédéric</a></author></comment><comment><text><span class="comment-copy">if 500 Internal Server Error occurs for the configured website it is revealing server info.Can anyone help on this</span></text><author><a class="comment-user" href="/users/1235031/ravithejag" title="231 reputation">ravithejag</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>Scott Mitchell provides in a blog post solutions for <a href="http://www.4guysfromrolla.com/articles/120209-1.aspx">removing unnecessary headers</a>.</p>
<p>As already said here in other answers, for the <code>Server</code> header, there is the <a href="/a/1201377/1178314">http module solution</a> or the UrlScan module. (URLScan module is no more available in IIS7.5+. Use <a href="http://stackoverflow.com/a/12615970/1178314">URLRewrite instead for blanking it</a>.)</p>
<p>For <code>X-AspNet-Version</code> and <code>X-AspNetMvc-Version</code>, he provides a better way than removing them on each response: simply not generating them at all.</p>
<p>Use <code>enableVersionHeader</code> for disabling <code>X-AspNet-Version</code>, in web.config</p>
<pre class="lang-xml prettyprint prettyprinted" style=""><code><span class="tag">&lt;httpRuntime</span><span class="pln"> </span><span class="atn">enableVersionHeader</span><span class="pun">=</span><span class="atv">"false"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>Use <code>MvcHandler.DisableMvcResponseHeader</code> in .Net Application_Start event for disabling <code>X-AspNetMvc-Version</code></p>
<pre class="lang-cs prettyprint prettyprinted" style=""><code><span class="typ">MvcHandler</span><span class="pun">.</span><span class="typ">DisableMvcResponseHeader</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span></code></pre>
<p>And finally, remove in IIS configuration the <code>X-Powered-By</code> custom header.</p>
<p>Do not forget that solution by application code does not apply by default to header generated on static content (you may activate the <code>runAllManagedModulesForAllRequests</code> for changing that, but it causes all requests to run .Net pipeline). It is not an issue for <code>X-AspNetMvc-Version</code> since it is not added on static content (at least if static request are not run in .Net pipeline).</p>
<p>Side note: when the aim is to cloak used technology, you should also change standard .Net cookie names (<code>.ASPXAUTH</code> if forms auth activated (use <code>name</code> attribute on <code>forms</code> tag in web.config), <code>ASP.NET_SessionId</code> (use <code>&lt;sessionState cookieName="yourName" /&gt;</code> in web.config under <code>system.web</code> tag), <code>__RequestVerificationToken</code> (change it by code with <code>AntiForgeryConfig.CookieName</code>, but unfortunately does not apply to the hidden input this system generates in the html)).</p>
</div></text><author><a href="/users/1178314/fr%c3%a9d%c3%a9ric">Frédéric</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>Actually the coded modules and the Global.asax examples shown above only work for valid requests.</p>
<p>For example, add &lt; on the end of your URL and you will get a "Bad request" page which still exposes the server header.  A lot of developers overlook this.</p>
<p>The registry settings shown do not work either.  URLScan is the ONLY way to remove the "server" header (at least in IIS 7.5).</p>
</div></text><author><a href="/users/1820350/stan-stare">Stan Stare</a></author><comments><comment><text><span class="comment-copy">It's working for me with the coded module (added in web.config) even on an bad request ;) In global.asax it's not really working (e.g. static files etc.)</span></text><author><a class="comment-user" href="/users/574379/kapsi" title="627 reputation">kapsi</a></author></comment><comment><text><span class="comment-copy">Lets hope you still have request validation switched on.</span></text><author><a class="comment-user" href="/users/1820350/stan-stare" title="346 reputation">Stan Stare</a></author></comment><comment><text><span class="comment-copy">does anyone have an alternative to urlscan for IIS 8+?</span></text><author><a class="comment-user" href="/users/687820/herostwist" title="2,087 reputation">herostwist</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>Or add in web.config:</p>
<pre class="lang-xml prettyprint prettyprinted" style=""><code><span class="tag">&lt;system.webServer&gt;</span><span class="pln">
    </span><span class="tag">&lt;httpProtocol&gt;</span><span class="pln">
        </span><span class="tag">&lt;customHeaders&gt;</span><span class="pln">
            </span><span class="tag">&lt;remove</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"X-AspNet-Version"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
            </span><span class="tag">&lt;remove</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"X-AspNetMvc-Version"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
            </span><span class="tag">&lt;remove</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"X-Powered-By"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
            </span><span class="com">&lt;!-- &lt;remove name="Server" /&gt;  this one doesn't work --&gt;</span><span class="pln">
        </span><span class="tag">&lt;/customHeaders&gt;</span><span class="pln">
    </span><span class="tag">&lt;/httpProtocol&gt;</span><span class="pln">
</span><span class="tag">&lt;/system.webServer&gt;</span></code></pre>
</div></text><author><a href="/users/2932371/anders">Anders</a></author><comments><comment><text><span class="comment-copy">This method doesn't remove the 'Server' header. The others are removed.</span></text><author><a class="comment-user" href="/users/30674/pure-krome" title="39,396 reputation">Pure.Krome</a></author></comment><comment><text><span class="comment-copy">You can get rid of the X-Powered-By in the Response headers configuration on the server level.</span></text><author><a class="comment-user" href="/users/1543844/snowburnt" title="2,362 reputation">Snowburnt</a></author></comment><comment><text><span class="comment-copy">I don't know if there is a cases where this way removes <code>X-AspNet-Version</code> and <code>X-AspNetMvc-Version</code> header. What I know is this way does not always work (if it ever works). See @Frederic answer for a more reliable way to remove them.</span></text><author><a class="comment-user" href="/users/121097/thebluesky" title="1,175 reputation">TheBlueSky</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>To remove the <code>Server:</code> header, go to <code>Global.asax</code>, find/create the <code>Application_PreSendRequestHeaders</code> event and add a line as follows (thanks to <a href="http://stackoverflow.com/a/7338448/590558">BK</a> and <a href="http://www.bugwriter.me/2010/01/removing-unnecessary-http-header-server.html" rel="noreferrer">this blog</a> this will also not fail on the Cassini / local dev):</p>
<pre class="lang-cs prettyprint prettyprinted" style=""><code><span class="kwd">protected</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Application_PreSendRequestHeaders</span><span class="pun">(</span><span class="kwd">object</span><span class="pln"> sender</span><span class="pun">,</span><span class="pln"> </span><span class="typ">EventArgs</span><span class="pln"> e</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="com">// Remove the "Server" HTTP Header from response</span><span class="pln">
    </span><span class="typ">HttpApplication</span><span class="pln"> app </span><span class="pun">=</span><span class="pln"> sender </span><span class="kwd">as</span><span class="pln"> </span><span class="typ">HttpApplication</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">null</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> app </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="kwd">null</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> app</span><span class="pun">.</span><span class="typ">Request</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">!</span><span class="pln">app</span><span class="pun">.</span><span class="typ">Request</span><span class="pun">.</span><span class="typ">IsLocal</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln">
        </span><span class="kwd">null</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> app</span><span class="pun">.</span><span class="typ">Context</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="kwd">null</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> app</span><span class="pun">.</span><span class="typ">Context</span><span class="pun">.</span><span class="typ">Response</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="typ">NameValueCollection</span><span class="pln"> headers </span><span class="pun">=</span><span class="pln"> app</span><span class="pun">.</span><span class="typ">Context</span><span class="pun">.</span><span class="typ">Response</span><span class="pun">.</span><span class="typ">Headers</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">null</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> headers</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            headers</span><span class="pun">.</span><span class="typ">Remove</span><span class="pun">(</span><span class="str">"Server"</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>If you want a complete solution to remove all related headers on Azure/IIS7 and also works with Cassini, see <a href="http://stackoverflow.com/questions/12803972/removing-hiding-disabling-excessive-http-response-headers-in-azure-iis7-without">this link</a>, which shows the best way to disable these headers without using HttpModules or URLScan.</p>
</div></text><author><a href="/users/590558/nick-evans">Nick Evans</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>Addition to the <a href="http://stackoverflow.com/a/12615970/1218980">URL Rewrite answer</a>, here is the complete XML for <code>web.config</code></p>
<pre class="lang-xml prettyprint prettyprinted" style=""><code><span class="tag">&lt;system.webServer&gt;</span><span class="pln">
  </span><span class="tag">&lt;rewrite&gt;</span><span class="pln">
    </span><span class="tag">&lt;outboundRules&gt;</span><span class="pln">
      </span><span class="tag">&lt;rule</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"Remove RESPONSE_Server"</span><span class="pln"> </span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;match</span><span class="pln"> </span><span class="atn">serverVariable</span><span class="pun">=</span><span class="atv">"RESPONSE_Server"</span><span class="pln"> </span><span class="atn">pattern</span><span class="pun">=</span><span class="atv">".+"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
        </span><span class="tag">&lt;action</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"Rewrite"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"Company name"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
      </span><span class="tag">&lt;/rule&gt;</span><span class="pln">
    </span><span class="tag">&lt;/outboundRules&gt;</span><span class="pln">
  </span><span class="tag">&lt;/rewrite&gt;</span><span class="pln">
</span><span class="tag">&lt;/system.webServer&gt;</span></code></pre>
<p><a href="http://www.iis.net/downloads/microsoft/url-rewrite" rel="nofollow noreferrer">URL Rewrite</a></p>
</div></text><author><a href="/users/187025/vaibhav-garg">Vaibhav Garg</a></author><comments><comment><text><span class="comment-copy">Does this remove all IIS and ASP versions from hacker</span></text><author><a class="comment-user" href="/users/2635161/aggie" title="184 reputation">aggie</a></author></comment><comment><text><span class="comment-copy">The above fix is working correctly for the web pages.But for images/icons if 500 Internal Server Error occurred it's showing the Server: Microsoft-IIS/7.5 instead of the value.Can you please help me on this</span></text><author><a class="comment-user" href="/users/1235031/ravithejag" title="231 reputation">ravithejag</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>If you just want to remove the header you can use a shortened version of lukiffer's answer:</p>
<pre class="lang-cs prettyprint prettyprinted" style=""><code><span class="pln">using </span><span class="typ">System</span><span class="pun">.</span><span class="typ">Web</span><span class="pun">;</span><span class="pln">

namespace </span><span class="typ">Site</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">sealed</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">HideServerHeaderModule</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="typ">IHttpModule</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Dispose</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="pun">}</span><span class="pln">

        </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Init</span><span class="pun">(</span><span class="typ">HttpApplication</span><span class="pln"> context</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            context</span><span class="pun">.</span><span class="typ">PreSendRequestHeaders</span><span class="pln"> </span><span class="pun">+=</span><span class="pln">
            </span><span class="pun">(</span><span class="pln">sender</span><span class="pun">,</span><span class="pln"> e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">HttpContext</span><span class="pun">.</span><span class="typ">Current</span><span class="pun">.</span><span class="typ">Response</span><span class="pun">.</span><span class="typ">Headers</span><span class="pun">.</span><span class="typ">Remove</span><span class="pun">(</span><span class="str">"Server"</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>And then in <code>Web.config</code>:</p>
<pre class="lang-xml prettyprint prettyprinted" style=""><code><span class="tag">&lt;system.webServer&gt;</span><span class="pln">
  </span><span class="tag">&lt;modules</span><span class="pln"> </span><span class="atn">runAllManagedModulesForAllRequests</span><span class="pun">=</span><span class="atv">"true"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;add</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"CustomHeaderModule"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"Site.HideServerHeaderModule"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/modules&gt;</span><span class="pln">
</span><span class="tag">&lt;/system.webServer&gt;</span></code></pre>
</div></text><author><a href="/users/24874/drew-noakes">Drew Noakes</a></author><comments><comment><text><span class="comment-copy">This is most appropriate because resources like css/js will not have the Server header, it ports from server to server without configuration and the Server response header won't just be empty, it will not be sent.</span></text><author><a class="comment-user" href="/users/9130/adam-caviness" title="2,129 reputation">Adam Caviness</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p>Try setting the <code>HKLM\SYSTEM\CurrentControlSet\Services\HTTP\Parameters\DisableServerHeader</code> registry entry to a <code>REG_DWORD</code> of <code>1</code>.</p>
</div></text><author><a href="/users/124386/richard-deeming">Richard Deeming</a></author><comments><comment><text><span class="comment-copy">Ran into an odd situation with our server farm where this registry setting seems to be the only change that works across all of the OS's (W2K8, W2K3) we're using, for both IIS6 and IIS7.</span></text><author><a class="comment-user" href="/users/375303/jerhewet" title="863 reputation">jerhewet</a></author></comment><comment><text><span class="comment-copy">Frustratingly, this isn't making any difference for me, even after rebooting the virtual machine. We're running IIS 7.5 on Windows Server 2008 R2 Standard, "Version 6.1 (Build 7601: Service Pack 1)". Similarly, my <code>OnPreSendRequestHeaders</code> event handler (see above) is never firing, for some reason.</span></text><author><a class="comment-user" href="/users/205245/owen-blacker" title="2,662 reputation">Owen Blacker</a></author></comment><comment><text><span class="comment-copy">Unfortunately the registry key doesn't seem to work on IIS 7.5</span></text><author><a class="comment-user" href="/users/73550/andrew-csontos" title="607 reputation">Andrew Csontos</a></author></comment></comments></answer><answer><text><div class="post-text" itemprop="text">
<p><a href="http://www.iis.net/extensions/UrlScan" rel="nofollow noreferrer">UrlScan </a> can also remove the server header by using <code>AlternateServerName=</code> under <code>[options]</code>.</p>
</div></text><author><a href="/users/5769/eddiegroves">eddiegroves</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>Following up on <a href="http://stackoverflow.com/a/1252865">eddiegroves' answer</a>, depending on the version of URLScan, you may instead prefer <code>RemoveServerHeader=1</code> under <code>[options]</code>.</p>
<p>I'm not sure in which version of URLScan this option was added, but it has been available in version 2.5 and later.</p>
</div></text><author><a href="/users/925793/techtician">techtician</a></author><comments/></answer><answer><text><div class="post-text" itemprop="text">
<p>I found an article that explains why we need to do both Registry edit and use a tool such as UrlScan to set this up in IIS properly. I followed it on our servers and it works: <a href="http://blogs.msdn.com/b/varunm/archive/2013/04/23/remove-unwanted-http-response-headers.aspx" rel="nofollow">http://blogs.msdn.com/b/varunm/archive/2013/04/23/remove-unwanted-http-response-headers.aspx</a>. If you only use UrlScan but don't do the registry change, during the time you are stopping World Wide Publishing Service, your server will return server http response from the HTTP.sys file. Also, here are common pitfals of using UrlScan tool: <a href="http://msdn.microsoft.com/en-us/library/ff648552.aspx#ht_urlscan_008" rel="nofollow">http://msdn.microsoft.com/en-us/library/ff648552.aspx#ht_urlscan_008</a></p>
</div></text><author><a href="/users/1024146/pawel">Pawel</a></author><comments><comment><text><span class="comment-copy">Please post your code on Stack Overflow. Links can change and break, so posting code is much more helpful</span></text><author><a class="comment-user" href="/users/2430414/radical-fanatic" title="2,421 reputation">Radical Fanatic</a></author></comment></comments></answer></answers></post>